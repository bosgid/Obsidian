/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// src/main.ts
__export(exports, {
  default: () => BibleLinkerPlugin
});
var import_obsidian7 = __toModule(require("obsidian"));

// src/modals/copy-verse-modal.ts
var import_obsidian3 = __toModule(require("obsidian"));

// src/logic/copy-command.ts
var import_obsidian2 = __toModule(require("obsidian"));

// src/utils/regexes.ts
var oneVerseRegEx = new RegExp(/([^,:#]+)[,#.:;]\s*(\d+)\s*$/);
var multipleVersesRegEx = new RegExp(/([^,:#]+)[,#.:;]\s*(\d+)\s*[-.=]\s*(\d+)\s*$/);
var bookAndChapterRegexForOBSK = /([^,:#]+)\s(\d+)/;
var multipleChapters = /(\d*[^\d,:#]+)\s*(\d+)\s*-\s*(\d+)\s*$/;
var isOBSKFile = /([A-zÀ-ž0-9 ]+)-(\d{2,3})/;

// src/logic/common.ts
var import_obsidian = __toModule(require("obsidian"));
function capitalize(str) {
  str = str.toLocaleLowerCase();
  for (let i = 0; i < str.length; i++) {
    if (/[^\s\d.,#-]/.test(str.charAt(i))) {
      return str.slice(0, i) + str.charAt(i).toUpperCase() + str.slice(i + 1);
    }
  }
  return str;
}
function parseUserVerseInput(userInput, verbose = true) {
  let bookAndChapter;
  let beginVerse;
  let endVerse;
  switch (true) {
    case oneVerseRegEx.test(userInput): {
      const [, matchedChapter, matchedVerse] = userInput.match(oneVerseRegEx);
      bookAndChapter = matchedChapter;
      beginVerse = Number(matchedVerse);
      endVerse = Number(matchedVerse);
      break;
    }
    case multipleVersesRegEx.test(userInput): {
      const [, matchedChapter, matchedBeginVerse, matchedEndVerse] = userInput.match(multipleVersesRegEx);
      bookAndChapter = matchedChapter;
      beginVerse = Number(matchedBeginVerse);
      endVerse = Number(matchedEndVerse);
      break;
    }
    default: {
      if (verbose) {
        new import_obsidian.Notice(`Wrong format "${userInput}"`);
      }
      throw "Could not parse user input";
    }
  }
  return { bookAndChapter, beginVerse, endVerse };
}
function parseUserBookInput(userInput) {
  let book;
  let firstChapter;
  let lastChapter;
  switch (true) {
    case multipleChapters.test(userInput): {
      const [, matchedBook, matchedFirstChapter, matchedLastChapter] = userInput.match(multipleChapters);
      book = matchedBook.trim();
      firstChapter = Number(matchedFirstChapter);
      lastChapter = Number(matchedLastChapter);
      break;
    }
    default: {
      new import_obsidian.Notice(`Wrong format "${userInput}"`);
      throw "Could not parse user input";
    }
  }
  return { book, firstChapter, lastChapter };
}
function getFileByFilename(app, filename, path = "/") {
  let filenameCopy = filename;
  let tFile = app.metadataCache.getFirstLinkpathDest(filenameCopy, path);
  if (!tFile) {
    filenameCopy = tryConvertToOBSKFileName(filenameCopy);
    tFile = app.metadataCache.getFirstLinkpathDest(filenameCopy, path);
  }
  return { fileName: filenameCopy, tFile };
}
function tryConvertToOBSKFileName(bookAndChapter) {
  if (bookAndChapterRegexForOBSK.test(bookAndChapter)) {
    let [, book, number] = bookAndChapter.match(bookAndChapterRegexForOBSK);
    if (number.length == 1) {
      number = `0${number}`;
    }
    return `${book}-${number}`;
  }
}

// src/logic/copy-command.ts
function getTextOfVerses(app, userInput, settings, translationPath, linkOnly, verbose = true) {
  return __async(this, null, function* () {
    let { bookAndChapter, beginVerse, endVerse } = parseUserVerseInput(userInput, verbose);
    bookAndChapter = capitalize(bookAndChapter);
    const { fileName, tFile } = getFileByFilename(app, bookAndChapter, translationPath);
    if (tFile) {
      return yield createCopyOutput(app, tFile, fileName, beginVerse, endVerse, settings, translationPath, linkOnly, verbose);
    } else {
      if (verbose) {
        new import_obsidian2.Notice(`File ${bookAndChapter} not found`);
      }
      throw "File not found";
    }
  });
}
function getVerseText(verseNumber, headings, lines, keepNewlines, newLinePrefix) {
  if (verseNumber >= headings.length) {
    new import_obsidian2.Notice("Verse out of range for given file");
    throw `VerseNumber ${verseNumber} is out of range of headings with length ${headings.length}`;
  }
  const headingLine = headings[verseNumber].position.start.line;
  if (headingLine + 1 >= lines.length) {
    new import_obsidian2.Notice("Logical error - please create issue on plugin's GitHub with your input and the file you were referencing. Thank you!");
    throw `HeadingLine ${headingLine + 1} is out of range of lines with length ${lines}`;
  }
  let output = "";
  let line = "";
  let i = 1;
  let isFirst = true;
  while (true) {
    line = lines[headingLine + i];
    if (/^#/.test(line) || !line && !isFirst) {
      break;
    }
    i++;
    if (line) {
      if (!isFirst) {
        output += keepNewlines ? `
${newLinePrefix}` : " ";
      }
      isFirst = false;
      output += line;
    }
  }
  return output;
}
function replaceNewline(input) {
  return input.replace(/\\n/g, "\n");
}
function createBookAndChapterOutput(fileBasename) {
  if (isOBSKFile.test(fileBasename)) {
    let [, filename, chapter] = fileBasename.match(isOBSKFile);
    if (chapter.toString()[0] === "0") {
      chapter = chapter.substring(1);
    }
    return filename + " " + chapter;
  }
  return fileBasename;
}
function getFileFolderInTranslation(app, filename, translation) {
  const tFileInfo = getFileByFilename(app, filename, translation);
  return tFileInfo.tFile.parent.path;
}
function createCopyOutput(app, tFile, fileName, beginVerse, endVerse, settings, translationPath, linkOnly, verbose) {
  return __async(this, null, function* () {
    const bookAndChapterOutput = createBookAndChapterOutput(tFile.basename);
    const file = app.vault.read(tFile);
    const lines = (yield file).split(/\r?\n/);
    const verseHeadingLevel = settings.verseHeadingLevel;
    const headings = app.metadataCache.getFileCache(tFile).headings.filter((heading) => !verseHeadingLevel || heading.level === verseHeadingLevel);
    const beginVerseNoOffset = beginVerse;
    beginVerse += settings.verseOffset;
    endVerse += settings.verseOffset;
    var nrOfVerses = headings.length - 1;
    var maxVerse = endVerse < nrOfVerses ? endVerse : nrOfVerses;
    var maxVerseNoOffset = maxVerse - settings.verseOffset;
    if (beginVerse > maxVerse) {
      if (verbose) {
        new import_obsidian2.Notice("Begin verse is bigger than end verse or chapter maximum");
      }
      throw "Begin verse is bigger than end verse or chapter maximum";
    }
    let postfix = "", res = "", pathToUse = "";
    if (!linkOnly) {
      res = settings.prefix;
      postfix = settings.postfix ? replaceNewline(settings.postfix) : " ";
    }
    if (settings.enableMultipleTranslations) {
      if (settings.translationLinkingType !== "main")
        pathToUse = getFileFolderInTranslation(app, fileName, translationPath);
      else {
        pathToUse = getFileFolderInTranslation(app, fileName, settings.parsedTranslationPaths.first());
      }
    }
    if (beginVerse === maxVerse) {
      res += `[[${pathToUse ? pathToUse + "/" : ""}${fileName}#${headings[beginVerse].heading}|${bookAndChapterOutput}${settings.oneVerseNotation}${beginVerseNoOffset}]]${postfix}`;
    } else if (settings.linkEndVerse) {
      res += `[[${pathToUse ? pathToUse + "/" : ""}${fileName}#${headings[beginVerse].heading}|${bookAndChapterOutput}${settings.multipleVersesNotation}${beginVerseNoOffset}-]]`;
      res += `[[${pathToUse ? pathToUse + "/" : ""}${fileName}#${headings[maxVerse].heading}|${maxVerseNoOffset}]]${postfix}`;
    } else {
      res += `[[${pathToUse ? pathToUse + "/" : ""}${fileName}#${headings[beginVerse].heading}|${bookAndChapterOutput}${settings.multipleVersesNotation}${beginVerseNoOffset}-${maxVerseNoOffset}]]${postfix}`;
    }
    if (!linkOnly) {
      for (let i = beginVerse; i <= maxVerse; i++) {
        let versePrefix = "";
        const versePostfix = settings.insertSpace ? " " : "";
        if (settings.eachVersePrefix) {
          versePrefix += settings.eachVersePrefix.replace(/{n}/g, (i - settings.verseOffset).toString());
          versePrefix = versePrefix.replace(/{f}/g, `${fileName}`);
        }
        const verseText = getVerseText(i, headings, lines, settings.newLines, settings.prefix);
        if (settings.newLines) {
          res += "\n" + settings.prefix + versePrefix + verseText;
        } else {
          res += versePrefix + verseText + versePostfix;
        }
      }
    }
    if (!settings.useInvisibleLinks)
      return res;
    if (beginVerse == maxVerse && (!settings.enableMultipleTranslations || settings.translationLinkingType === "main" || settings.translationLinkingType === "used"))
      return res;
    if (settings.newLines && !linkOnly) {
      res += `
${settings.prefix}`;
    }
    const lastVerseToLink = settings.linkEndVerse ? maxVerse - 1 : maxVerse;
    for (let i = beginVerse + 1; i <= lastVerseToLink; i++) {
      if (!settings.enableMultipleTranslations) {
        res += `[[${fileName}#${headings[i].heading}|]]`;
      } else {
        let translationPathsToUse = [];
        switch (settings.translationLinkingType) {
          case "all":
            translationPathsToUse = settings.parsedTranslationPaths.map((tr) => getFileFolderInTranslation(app, fileName, tr));
            break;
          case "used":
            translationPathsToUse = [getFileFolderInTranslation(app, fileName, translationPath)];
            break;
          case "usedAndMain":
            if (translationPath !== settings.parsedTranslationPaths.first()) {
              translationPathsToUse = [
                getFileFolderInTranslation(app, fileName, translationPath),
                getFileFolderInTranslation(app, fileName, settings.parsedTranslationPaths.first())
              ];
            } else {
              translationPathsToUse = [getFileFolderInTranslation(app, fileName, translationPath)];
            }
            break;
          case "main":
            translationPathsToUse = [getFileFolderInTranslation(app, fileName, settings.parsedTranslationPaths.first())];
            break;
          default:
            break;
        }
        translationPathsToUse.forEach((translationPath2) => {
          res += `[[${translationPath2}/${fileName}#${headings[i].heading}|]]`;
        });
      }
    }
    return res;
  });
}

// src/modals/copy-verse-modal.ts
function setPreviewText(previewEl, userInput, pluginSettings, translationPath, linkOnly) {
  return __async(this, null, function* () {
    try {
      const res = yield getTextOfVerses(this.app, userInput, pluginSettings, translationPath, linkOnly, false);
      previewEl.setText(res);
    } catch (e) {
      previewEl.setText("");
      return;
    }
  });
}
var LinkType;
(function(LinkType3) {
  LinkType3["First"] = "First verse";
  LinkType3["FirstOtherInvis"] = "First verse + other invisible";
  LinkType3["FirstLast"] = "First and last verse";
  LinkType3["FirstLastOtherInvis"] = "First and last + other invisible";
  LinkType3["All"] = "All verses";
  LinkType3["AllInvis"] = "All verses, invisible";
})(LinkType || (LinkType = {}));
var CopyVerseModal = class extends import_obsidian3.Modal {
  constructor(app, settings, onSubmit) {
    super(app);
    this.handleInput = () => __async(this, null, function* () {
      try {
        const res = yield getTextOfVerses(this.app, this.userInput, this.pluginSettings, this.translationPath, this.linkOnly);
        this.close();
        this.onSubmit(res);
      } catch (err) {
        return;
      }
    });
    this.onSubmit = onSubmit;
    this.pluginSettings = settings;
  }
  onOpen() {
    const { contentEl } = this;
    let previewEl;
    const refreshPreview = () => {
      setPreviewText(previewEl, this.userInput, this.pluginSettings, this.translationPath, this.linkOnly);
    };
    contentEl.createEl("h3", { text: "Copy verse by bible reference" });
    new import_obsidian3.Setting(contentEl).setName("Insert reference").addText((text) => text.onChange((value) => {
      this.userInput = value;
      refreshPreview();
    }).inputEl.focus());
    if (this.pluginSettings.enableMultipleTranslations && this.pluginSettings.translationsPaths !== "") {
      const transationPicker = new import_obsidian3.Setting(contentEl).setName("Pick translation");
      let buttons = [];
      let buttonPathMap = new Map();
      this.pluginSettings.parsedTranslationPaths.forEach((path) => {
        transationPicker.addButton((btn) => {
          buttons.push(btn);
          buttonPathMap.set(btn, path);
          let splittedPath = path.split("/");
          btn.setButtonText(splittedPath[splittedPath.length - 2]);
        });
        buttons.forEach((btn) => {
          btn.onClick(() => {
            buttons.forEach((b) => b.removeCta());
            btn.setCta();
            this.translationPath = buttonPathMap.get(btn);
            refreshPreview();
          });
        });
        buttons.first().setCta();
        this.translationPath = buttonPathMap.get(buttons.first());
      });
    }
    this.linkOnly = this.pluginSettings.linkOnly;
    new import_obsidian3.Setting(contentEl).setName("Link only").addToggle((tgl) => {
      tgl.setValue(this.pluginSettings.linkOnly);
      tgl.onChange((val) => {
        this.linkOnly = val;
        refreshPreview();
      });
    });
    contentEl.createEl("label", { text: "Preview" });
    previewEl = contentEl.createEl("textarea", { cls: "copy-preview", attr: { readonly: true } });
    new import_obsidian3.Setting(contentEl).addButton((btn) => {
      btn.setButtonText("Link").setCta().onClick(this.handleInput);
    });
    contentEl.onkeydown = (event) => {
      if (event.key === "Enter") {
        event.preventDefault();
        this.handleInput();
      }
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/modals/link-verse-modal.ts
var import_obsidian5 = __toModule(require("obsidian"));

// src/logic/link-command.ts
var import_obsidian4 = __toModule(require("obsidian"));
function createLinks(app, userInput, linkType, useNewLine, settings) {
  return __async(this, null, function* () {
    if (multipleChapters.test(userInput)) {
      return getLinksForChapters(app, userInput, linkType, useNewLine, settings);
    } else {
      return getLinksForVerses(app, userInput, linkType, useNewLine, settings);
    }
  });
}
function getLinksForVerses(app, userInput, linkType, useNewLine, settings) {
  return __async(this, null, function* () {
    let { bookAndChapter, beginVerse, endVerse } = parseUserVerseInput(userInput);
    bookAndChapter = capitalize(bookAndChapter);
    if (settings.verifyFilesWhenLinking) {
      const { fileName, tFile } = getFileByFilename(app, bookAndChapter);
      if (!tFile) {
        new import_obsidian4.Notice(`File "${fileName}" does not exist and verify files is set to true`);
        throw `File ${fileName} does not exist, verify files = true`;
      }
    }
    if (beginVerse > endVerse) {
      new import_obsidian4.Notice("Begin verse is bigger than end verse");
      throw "Begin verse is bigger than end verse";
    }
    let res = "";
    const beginning = linkType === LinkType2.Embedded ? "!" : "";
    const ending = linkType === LinkType2.Invisible ? "|" : "";
    for (let i = beginVerse; i <= endVerse; i++) {
      res += `${beginning}[[${bookAndChapter}${settings.linkSeparator}${settings.versePrefix}${i}${ending}]]`;
      if (useNewLine) {
        res += "\n";
      }
    }
    return res;
  });
}
function getLinksForChapters(app, userInput, linkType, useNewLine, settings) {
  return __async(this, null, function* () {
    const { book, firstChapter, lastChapter } = parseUserBookInput(userInput);
    if (firstChapter > lastChapter) {
      new import_obsidian4.Notice("Begin chapter is bigger than end chapter");
      throw "Begin chapter is bigger than end chapter";
    }
    let res = "";
    for (let i = firstChapter; i <= lastChapter; i++) {
      res += `[[${book} ${i}]]`;
      if (useNewLine) {
        res += "\n";
      }
    }
    return res;
  });
}

// src/modals/link-verse-modal.ts
var LinkType2;
(function(LinkType3) {
  LinkType3["Basic"] = "Basic";
  LinkType3["Embedded"] = "Embedded";
  LinkType3["Invisible"] = "Invisible";
})(LinkType2 || (LinkType2 = {}));
var LinkVerseModal = class extends import_obsidian5.Modal {
  constructor(app, settings, onSubmit) {
    super(app);
    this.handleInput = () => __async(this, null, function* () {
      try {
        const res = yield createLinks(this.app, this.userInput, this.linkType, this.useNewLine, this.pluginSettings);
        this.close();
        this.onSubmit(res);
      } catch (err) {
        return;
      }
    });
    this.onSubmit = onSubmit;
    this.pluginSettings = settings;
    this.linkType = this.pluginSettings.linkTypePreset;
    this.useNewLine = this.pluginSettings.newLinePreset;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h3", { text: "Create Obsidian links from Bible reference" });
    new import_obsidian5.Setting(contentEl).setName("Insert reference").addText((text) => text.onChange((value) => {
      this.userInput = value;
    }).inputEl.focus());
    new import_obsidian5.Setting(contentEl).setName("Link type").addDropdown((dropdown) => {
      dropdown.addOption(LinkType2.Basic, LinkType2.Basic);
      dropdown.addOption(LinkType2.Embedded, LinkType2.Embedded);
      dropdown.addOption(LinkType2.Invisible, LinkType2.Invisible);
      dropdown.onChange((value) => this.linkType = value);
      dropdown.setValue(this.pluginSettings.linkTypePreset);
    });
    new import_obsidian5.Setting(contentEl).setName("Each link on new line?").addToggle((tgl) => {
      tgl.setValue(this.pluginSettings.newLinePreset);
      tgl.onChange((val) => {
        this.useNewLine = val;
      });
    });
    new import_obsidian5.Setting(contentEl).addButton((btn) => {
      btn.setButtonText("Link").setCta().onClick(this.handleInput);
    });
    contentEl.onkeydown = (event) => {
      if (event.key === "Enter") {
        event.preventDefault();
        this.handleInput();
      }
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/settings.ts
var import_obsidian6 = __toModule(require("obsidian"));
var SettingsTab = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Copy and Link Bible verses command" });
    containerEl.createEl("h4", { text: "Functional" });
    new import_obsidian6.Setting(containerEl).setName("Verse offset").setDesc('Change this if wrong verses are being linked, e.g. you want "Gen 1,1-3" but output is text from verses 2-4 \u2192 set this to -1').setClass("important-setting").addText((inputBox) => inputBox.setValue(this.plugin.settings.verseOffset.toString()).onChange((value) => __async(this, null, function* () {
      const number = Number.parseInt(value);
      if (value === "-")
        return;
      if (Number.isNaN(number)) {
        new import_obsidian6.Notice("Invalid input, please insert valid integer");
        inputBox.setValue("");
        return;
      }
      this.plugin.settings.verseOffset = number;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Verse heading level").setDesc('If set, only headings of specified level are considered verses (if first heading of this level is always a verse, also set "Verse offset" to -1)').addDropdown((dropdown) => {
      var _a, _b;
      dropdown.addOption("any", "any");
      dropdown.addOption("6", "######");
      dropdown.addOption("5", "#####");
      dropdown.addOption("4", "####");
      dropdown.addOption("3", "###");
      dropdown.addOption("2", "##");
      dropdown.addOption("1", "#");
      dropdown.setValue((_b = (_a = this.plugin.settings.verseHeadingLevel) == null ? void 0 : _a.toString()) != null ? _b : "any");
      dropdown.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.verseHeadingLevel = value === "any" ? void 0 : Number(value);
        yield this.plugin.saveSettings();
      }));
    });
    containerEl.createEl("h4", { text: "Inserted prefixes/postfixes" });
    new import_obsidian6.Setting(containerEl).setName("Line prefix").setDesc("String inserted in front of every line, for example '>' for quote. Note: If you set 'Put each verse on a new line?' to true, the prefix will be inserted in front of every line.").setClass("important-setting").addText((inputBox) => inputBox.setPlaceholder("Insert prefix here").setValue(this.plugin.settings.prefix).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.prefix = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Link postfix").setDesc("String inserted after biblical link, you can use \\n to insert newline.").addText((inputBox) => inputBox.setPlaceholder("Insert postfix here").setValue(this.plugin.settings.postfix).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.postfix = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Each verse prefix").setDesc('String inserted in front of every copied verse. You can use "{n}" where you want number of given verse inserted, for example "**{n}** " will make each verse start with bold verse number. You can also use "{f}" to insert name of the corresponding file (for example to create obsidian links). Leave empty for no prefix.').addText((inputBox) => inputBox.setPlaceholder("Insert prefix here").setValue(this.plugin.settings.eachVersePrefix).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.eachVersePrefix = value;
      yield this.plugin.saveSettings();
    })));
    containerEl.createEl("h4", { text: "Links" });
    new import_obsidian6.Setting(containerEl).setName("Link to last verse?").setDesc("Should last verse be linked in the visible link before text of verses?").addToggle((toggle) => toggle.setValue(this.plugin.settings.linkEndVerse).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.linkEndVerse = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Add invisible links?").setDesc("Invisible links are added to each verse used (so you can find the connections later), they are only visible in source mode.").addToggle((toggle) => toggle.setValue(this.plugin.settings.useInvisibleLinks).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.useInvisibleLinks = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Link only default").setDesc("What the link only option should be set to by default").addToggle((toggle) => toggle.setValue(this.plugin.settings.linkOnly).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.linkOnly = value;
      yield this.plugin.saveSettings();
    })));
    containerEl.createEl("h4", { text: "Output format" });
    new import_obsidian6.Setting(containerEl).setName("Put each verse on a new line?").setDesc("Each verse is inserted on a new line (with Link prefix).").addToggle((toggle) => toggle.setValue(this.plugin.settings.newLines).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.newLines = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Insert space between verses?").setDesc("Should space be inserted between verses? (Only applied when Put each verse on a new line? is se to false. Useful for languages such as Chinese.)").setDisabled(!this.plugin.settings.newLines).addToggle((toggle) => toggle.setValue(this.plugin.settings.insertSpace).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.insertSpace = value;
      yield this.plugin.saveSettings();
    })));
    containerEl.createEl("h4", { text: "Notation" });
    new import_obsidian6.Setting(containerEl).setName("One verse notation").setDesc('This is the symbol that will be used between chapter number and verse number when copying one verse. For example "." \u2192 Gen 1.1.').addText((inputBox) => inputBox.setPlaceholder("Insert notation symbol here").setValue(this.plugin.settings.oneVerseNotation).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.oneVerseNotation = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Multiple verses notation").setDesc('This is the symbol that will be used between chapter number and verse number when copying multiple verses. For example "," \u2192 Gen 1,1-3.').addText((inputBox) => inputBox.setPlaceholder("Insert notation symbol here").setValue(this.plugin.settings.multipleVersesNotation).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.multipleVersesNotation = value;
      yield this.plugin.saveSettings();
    })));
    containerEl.createEl("h4", { text: "Multiple translations" });
    new import_obsidian6.Setting(containerEl).setName("Enable multiple translations").addToggle((toggle) => toggle.setValue(this.plugin.settings.enableMultipleTranslations).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.enableMultipleTranslations = value;
      yield this.plugin.saveSettings();
      this.display();
    })));
    if (this.plugin.settings.enableMultipleTranslations) {
      new import_obsidian6.Setting(containerEl).setName("Paths to translations with their names").setDesc('Input full paths from the root valut folder to folders containing Bible translations, each trnaslation on separate line. An example of one entry: "Bible/NIV/". The plugin will search for corresponding Bible files using given paths as starting points. Make sure there are no duplicate files in given paths, otherwise it is hard to tell what the output will be. The first translation will be considered your main translation.').addTextArea((inputBox) => inputBox.setPlaceholder("Bible/NIV/\nBible/ESV/").setValue(this.plugin.settings.translationsPaths).onChange((value) => __async(this, null, function* () {
        const inputPaths = value.split(/\r?\n|\r/);
        const paths = [];
        inputPaths.forEach((path) => {
          if (path.at(-1) !== "/") {
            paths.push(path + "/");
          } else {
            paths.push(path);
          }
        });
        this.plugin.settings.translationsPaths = value;
        this.plugin.settings.parsedTranslationPaths = paths;
        yield this.plugin.saveSettings();
      })));
      new import_obsidian6.Setting(containerEl).setName("What to link").setDesc("Choose what translations should be linked when copying a verse.").addDropdown((dropdown) => {
        dropdown.addOption("all", "Link to all translations");
        dropdown.addOption("used", "Link only to used translation");
        dropdown.addOption("usedAndMain", "Link to used and main translation");
        dropdown.addOption("main", "Link only to main translation");
        dropdown.setValue(this.plugin.settings.translationLinkingType);
        dropdown.onChange((value) => __async(this, null, function* () {
          this.plugin.settings.translationLinkingType = value;
          yield this.plugin.saveSettings();
        }));
      });
    }
    containerEl.createEl("h2", { text: "Link Bible verses command" });
    containerEl.createEl("h4", { text: "File format" });
    new import_obsidian6.Setting(containerEl).setName("Link separator").setDesc("This is the separator that will be used when linking, e.g. if you enter '#' here, output will be [[Gen 1#1]]. If you are using headings to mark verses, use '#'. If you are using block references, use '^'.").setClass("important-setting").addText((inputBox) => inputBox.setPlaceholder("Insert separator here").setValue(this.plugin.settings.linkSeparator).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.linkSeparator = value;
      yield this.plugin.saveSettings();
    })));
    new import_obsidian6.Setting(containerEl).setName("Verse prefix").setDesc('Fill this if you are using verse prefixes in your bible files, e.g. you have "v1" in your file \u2192 set to "v".').setClass("important-setting").addText((inputBox) => inputBox.setPlaceholder("Insert prefix here").setValue(this.plugin.settings.versePrefix).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.versePrefix = value;
      yield this.plugin.saveSettings();
    })));
    containerEl.createEl("h4", { text: "Defaults" });
    new import_obsidian6.Setting(containerEl).setName("Link type default value").setDesc("Value that will be selected by default in link modal.").addDropdown((dropdown) => {
      dropdown.addOption(LinkType2.Basic, LinkType2.Basic);
      dropdown.addOption(LinkType2.Embedded, LinkType2.Embedded);
      dropdown.addOption(LinkType2.Invisible, LinkType2.Invisible);
      dropdown.setValue(this.plugin.settings.linkTypePreset);
      dropdown.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.linkTypePreset = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian6.Setting(containerEl).setName("Use new lines default value").setDesc("Value that will be selected by default in link modal.").addToggle((toggle) => toggle.setValue(this.plugin.settings.newLinePreset).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.newLinePreset = value;
      yield this.plugin.saveSettings();
    })));
    containerEl.createEl("h4", { text: "Misc" });
    new import_obsidian6.Setting(containerEl).setName("Verify files?").setDesc("Verify existence of files you are trying to link, so that you are not inserting wrong references by mistake.").addToggle((toggle) => toggle.setValue(this.plugin.settings.verifyFilesWhenLinking).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.verifyFilesWhenLinking = value;
      yield this.plugin.saveSettings();
    })));
  }
};

// src/main.ts
var DEFAULT_SETTINGS = {
  verseOffset: 0,
  verseHeadingLevel: void 0,
  prefix: "",
  postfix: "",
  eachVersePrefix: "",
  linkEndVerse: false,
  useInvisibleLinks: true,
  linkOnly: false,
  newLines: false,
  insertSpace: true,
  oneVerseNotation: ".",
  multipleVersesNotation: ",",
  enableMultipleTranslations: false,
  translationsPaths: "",
  parsedTranslationPaths: [],
  translationLinkingType: "all",
  linkSeparator: "#",
  versePrefix: "",
  linkTypePreset: LinkType2.Basic,
  newLinePreset: true,
  verifyFilesWhenLinking: false
};
var BibleLinkerPlugin = class extends import_obsidian7.Plugin {
  constructor() {
    super(...arguments);
    this.openCopyModal = () => {
      const view = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
      if (view) {
        new CopyVerseModal(this.app, this.settings, (str) => view.editor.replaceRange(str, view.editor.getCursor())).open();
      }
    };
    this.openObsidianLinkModal = () => {
      const view = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
      if (view) {
        new LinkVerseModal(this.app, this.settings, (str) => view.editor.replaceRange(str, view.editor.getCursor())).open();
      }
    };
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      yield this.saveData(this.settings);
    });
  }
  onload() {
    return __async(this, null, function* () {
      yield this.loadSettings();
      this.addSettingTab(new SettingsTab(this.app, this));
      this.addCommand({
        id: "insert-bible-link",
        name: "Copy and Link Bible verses",
        icon: "copy",
        editorCallback: this.openCopyModal
      });
      this.addCommand({
        id: "insert-bible-link-obsidian-link",
        name: "Link Bible verses",
        icon: "link",
        editorCallback: this.openObsidianLinkModal
      });
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL21vZGFscy9jb3B5LXZlcnNlLW1vZGFsLnRzIiwgInNyYy9sb2dpYy9jb3B5LWNvbW1hbmQudHMiLCAic3JjL3V0aWxzL3JlZ2V4ZXMudHMiLCAic3JjL2xvZ2ljL2NvbW1vbi50cyIsICJzcmMvbW9kYWxzL2xpbmstdmVyc2UtbW9kYWwudHMiLCAic3JjL2xvZ2ljL2xpbmstY29tbWFuZC50cyIsICJzcmMvc2V0dGluZ3MudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IE1hcmtkb3duVmlldywgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgQ29weVZlcnNlTW9kYWwsIHsgTGlua1R5cGUgYXMgQ29weUxpbmtUeXBlIH0gZnJvbSAnc3JjL21vZGFscy9jb3B5LXZlcnNlLW1vZGFsJztcclxuaW1wb3J0IExpbmtWZXJzZU1vZGFsLCB7IExpbmtUeXBlIH0gZnJvbSAnLi9tb2RhbHMvbGluay12ZXJzZS1tb2RhbCc7XHJcbmltcG9ydCB7IFNldHRpbmdzVGFiIH0gZnJvbSAnLi9zZXR0aW5ncyc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFBsdWdpblNldHRpbmdzIHtcclxuICAgIC8vIENPUFlcclxuICAgIC8vIEZ1bmN0aW9uYWxcclxuICAgIHZlcnNlT2Zmc2V0OiBudW1iZXI7XHJcbiAgICB2ZXJzZUhlYWRpbmdMZXZlbD86IG51bWJlcjtcclxuXHJcbiAgICAvLyBJbnNlcnRlZCBwcmVmaXhlcy9wb3N0Zml4ZXNcclxuICAgIHByZWZpeDogc3RyaW5nO1xyXG4gICAgcG9zdGZpeDogc3RyaW5nO1xyXG4gICAgZWFjaFZlcnNlUHJlZml4OiBzdHJpbmc7XHJcblxyXG4gICAgLy8gTGlua3NcclxuICAgIGxpbmtFbmRWZXJzZTogYm9vbGVhbjtcclxuICAgIHVzZUludmlzaWJsZUxpbmtzOiBib29sZWFuO1xyXG4gICAgbGlua09ubHk6IGJvb2xlYW47XHJcblxyXG4gICAgLy8gT3V0cHV0IGZvcm1hdFxyXG4gICAgbmV3TGluZXM6IGJvb2xlYW47XHJcbiAgICBpbnNlcnRTcGFjZTogYm9vbGVhbjtcclxuXHJcbiAgICAvLyBOb3RhdGlvblxyXG4gICAgb25lVmVyc2VOb3RhdGlvbjogc3RyaW5nO1xyXG4gICAgbXVsdGlwbGVWZXJzZXNOb3RhdGlvbjogc3RyaW5nO1xyXG5cclxuICAgIC8vIE11bHRpcGxlIHRyYW5zbGF0aW9uc1xyXG4gICAgZW5hYmxlTXVsdGlwbGVUcmFuc2xhdGlvbnM6IGJvb2xlYW47XHJcbiAgICB0cmFuc2xhdGlvbnNQYXRoczogc3RyaW5nO1xyXG4gICAgcGFyc2VkVHJhbnNsYXRpb25QYXRoczogc3RyaW5nW107IC8vIGNhbGxjdWxhdGVkIGZyb20gdHJhbnNsYXRpb25zIHBhdGhzLCBub3Qgc2hvd24gdG8gdGhlIHVzZXJcclxuICAgIHRyYW5zbGF0aW9uTGlua2luZ1R5cGU6IHN0cmluZztcclxuXHJcbiAgICAvLyBMSU5LXHJcbiAgICAvLyBGaWxlIGZvcm1hdFxyXG4gICAgbGlua1NlcGFyYXRvcjogc3RyaW5nO1xyXG4gICAgdmVyc2VQcmVmaXg6IHN0cmluZztcclxuXHJcbiAgICAvLyBEZWZhdWx0c1xyXG4gICAgbGlua1R5cGVQcmVzZXQ6IExpbmtUeXBlO1xyXG4gICAgbmV3TGluZVByZXNldDogYm9vbGVhbjtcclxuXHJcbiAgICAvLyBNaXNjXHJcbiAgICB2ZXJpZnlGaWxlc1doZW5MaW5raW5nOiBib29sZWFuO1xyXG59XHJcblxyXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBQYXJ0aWFsPFBsdWdpblNldHRpbmdzPiA9IHtcclxuICAgIC8vIENPUFlcclxuICAgIC8vIEZ1bmN0aW9uYWxcclxuICAgIHZlcnNlT2Zmc2V0OiAwLFxyXG4gICAgdmVyc2VIZWFkaW5nTGV2ZWw6IHVuZGVmaW5lZCxcclxuXHJcbiAgICAvLyBJbnNlcnRlZCBwcmVmaXhlcy9wb3N0Zml4ZXNcclxuICAgIHByZWZpeDogXCJcIixcclxuICAgIHBvc3RmaXg6IFwiXCIsXHJcbiAgICBlYWNoVmVyc2VQcmVmaXg6IFwiXCIsXHJcblxyXG4gICAgLy8gTGlua3NcclxuICAgIGxpbmtFbmRWZXJzZTogZmFsc2UsXHJcbiAgICB1c2VJbnZpc2libGVMaW5rczogdHJ1ZSxcclxuICAgIGxpbmtPbmx5OiBmYWxzZSxcclxuXHJcbiAgICAvLyBPdXRwdXQgZm9ybWF0XHJcbiAgICBuZXdMaW5lczogZmFsc2UsXHJcbiAgICBpbnNlcnRTcGFjZTogdHJ1ZSxcclxuXHJcbiAgICAvLyBOb3RhdGlvblxyXG4gICAgb25lVmVyc2VOb3RhdGlvbjogXCIuXCIsXHJcbiAgICBtdWx0aXBsZVZlcnNlc05vdGF0aW9uOiBcIixcIixcclxuXHJcbiAgICAvLyBNdWx0aXBsZSB0cmFuc2xhdGlvbnNcclxuICAgIGVuYWJsZU11bHRpcGxlVHJhbnNsYXRpb25zOiBmYWxzZSxcclxuICAgIHRyYW5zbGF0aW9uc1BhdGhzOiBcIlwiLFxyXG4gICAgcGFyc2VkVHJhbnNsYXRpb25QYXRoczogW10sXHJcbiAgICB0cmFuc2xhdGlvbkxpbmtpbmdUeXBlOiBcImFsbFwiLFxyXG5cclxuICAgIC8vIExJTktcclxuICAgIC8vIEZpbGUgZm9ybWF0XHJcbiAgICBsaW5rU2VwYXJhdG9yOiBcIiNcIixcclxuICAgIHZlcnNlUHJlZml4OiBcIlwiLFxyXG5cclxuICAgIC8vIERlZmF1bHRzXHJcbiAgICBsaW5rVHlwZVByZXNldDogTGlua1R5cGUuQmFzaWMsXHJcbiAgICBuZXdMaW5lUHJlc2V0OiB0cnVlLFxyXG5cclxuICAgIC8vIE1pc2NcclxuICAgIHZlcmlmeUZpbGVzV2hlbkxpbmtpbmc6IGZhbHNlLFxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCaWJsZUxpbmtlclBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcbiAgICBzZXR0aW5nczogUGx1Z2luU2V0dGluZ3M7XHJcblxyXG4gICAgLy8gT3BlbnMgbW9kYWwgZm9yIHRleHQgY29weWluZ1xyXG4gICAgb3BlbkNvcHlNb2RhbCA9ICgpID0+IHtcclxuICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuICAgICAgICBpZiAodmlldykge1xyXG4gICAgICAgICAgICBuZXcgQ29weVZlcnNlTW9kYWwodGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MsXHJcbiAgICAgICAgICAgICAgICAoc3RyKSA9PiB2aWV3LmVkaXRvci5yZXBsYWNlUmFuZ2Uoc3RyLCB2aWV3LmVkaXRvci5nZXRDdXJzb3IoKSkpLm9wZW4oKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gT3BlbnMgbW9kYWwgZm9yIGNyZWF0aW5nIG9ic2lkaWFuIGxpbmtzXHJcbiAgICBvcGVuT2JzaWRpYW5MaW5rTW9kYWwgPSAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcbiAgICAgICAgaWYgKHZpZXcpIHtcclxuICAgICAgICAgICAgbmV3IExpbmtWZXJzZU1vZGFsKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzLFxyXG4gICAgICAgICAgICAgICAgKHN0cikgPT4gdmlldy5lZGl0b3IucmVwbGFjZVJhbmdlKHN0ciwgdmlldy5lZGl0b3IuZ2V0Q3Vyc29yKCkpKS5vcGVuKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSlcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFJ1biBvbmNlIHdoZW4gcGx1Z2luIGlzIGxvYWRlZFxyXG4gICAgYXN5bmMgb25sb2FkKCkge1xyXG4gICAgICAgIC8vIEhhbmRsZSBzZXR0aW5nc1xyXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBTZXR0aW5nc1RhYih0aGlzLmFwcCwgdGhpcykpXHJcblxyXG4gICAgICAgIC8vIEFkZCBpY29uIHRvIGluc2VydCBsaW5rIFxyXG4gICAgICAgIC8vIHRoaXMuYWRkUmliYm9uSWNvbihcImxpbmtcIiwgXCJJbnNlcnQgYmlibGUgbGlua1wiLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB0aGlzLm9wZW5Db3B5TW9kYWwoKSk7XHJcblxyXG4gICAgICAgIC8vIENvbW1hbmQgdG8gaW5zZXJ0IGxpbmsgKG9ubHkgYXZhaWxhYmxlIGluIGVkaXRvciBtb2RlKVxyXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgICAgIGlkOiAnaW5zZXJ0LWJpYmxlLWxpbmsnLCAvLyBJRCBsZWZ0IHRvIHByZXNlcnZlIHVzZXIncyBrZXkgbWFwcGluZ3NcclxuICAgICAgICAgICAgbmFtZTogXCJDb3B5IGFuZCBMaW5rIEJpYmxlIHZlcnNlc1wiLFxyXG4gICAgICAgICAgICBpY29uOiBcImNvcHlcIixcclxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IHRoaXMub3BlbkNvcHlNb2RhbFxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vIENvbW1hbmQgdG8gaW5zZXJ0IGxpbmsgKG9ubHkgYXZhaWxhYmxlIGluIGVkaXRvciBtb2RlKVxyXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgICAgIGlkOiAnaW5zZXJ0LWJpYmxlLWxpbmstb2JzaWRpYW4tbGluaycsXHJcbiAgICAgICAgICAgIG5hbWU6IFwiTGluayBCaWJsZSB2ZXJzZXNcIixcclxuICAgICAgICAgICAgaWNvbjogXCJsaW5rXCIsXHJcbiAgICAgICAgICAgIGVkaXRvckNhbGxiYWNrOiB0aGlzLm9wZW5PYnNpZGlhbkxpbmtNb2RhbFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCwgQnV0dG9uQ29tcG9uZW50LCBNb2RhbCwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBQbHVnaW5TZXR0aW5ncyB9IGZyb20gXCIuLi9tYWluXCI7XHJcbmltcG9ydCB7IGdldFRleHRPZlZlcnNlcyB9IGZyb20gXCIuLi9sb2dpYy9jb3B5LWNvbW1hbmRcIjtcclxuXHJcbi8qKlxyXG4gKiBBc3luYyBmdW5jdGlvbiBmb3IgZmV0Y2hpbmcgcHJldmlldyBcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHNldFByZXZpZXdUZXh0KHByZXZpZXdFbDogSFRNTFRleHRBcmVhRWxlbWVudCwgdXNlcklucHV0OiBzdHJpbmcsIHBsdWdpblNldHRpbmdzOiBQbHVnaW5TZXR0aW5ncywgdHJhbnNsYXRpb25QYXRoOiBzdHJpbmcsIGxpbmtPbmx5OiBib29sZWFuKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldFRleHRPZlZlcnNlcyh0aGlzLmFwcCwgdXNlcklucHV0LCBwbHVnaW5TZXR0aW5ncywgdHJhbnNsYXRpb25QYXRoLCBsaW5rT25seSwgZmFsc2UpO1xyXG4gICAgICAgIHByZXZpZXdFbC5zZXRUZXh0KHJlcyk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCB7XHJcbiAgICAgICAgcHJldmlld0VsLnNldFRleHQoXCJcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZW51bSBMaW5rVHlwZSB7XHJcbiAgICBGaXJzdCA9IFwiRmlyc3QgdmVyc2VcIixcclxuICAgIEZpcnN0T3RoZXJJbnZpcyA9IFwiRmlyc3QgdmVyc2UgKyBvdGhlciBpbnZpc2libGVcIixcclxuICAgIEZpcnN0TGFzdCA9IFwiRmlyc3QgYW5kIGxhc3QgdmVyc2VcIixcclxuICAgIEZpcnN0TGFzdE90aGVySW52aXMgPSBcIkZpcnN0IGFuZCBsYXN0ICsgb3RoZXIgaW52aXNpYmxlXCIsXHJcbiAgICBBbGwgPSBcIkFsbCB2ZXJzZXNcIixcclxuICAgIEFsbEludmlzID0gXCJBbGwgdmVyc2VzLCBpbnZpc2libGVcIixcclxufVxyXG5cclxuLyoqXHJcbiAqIE1vZGFsIHRoYXQgbGV0cyB5b3UgaW5zZXJ0IGJpYmxlIHJlZmVyZW5jZSBieSBjb3B5aW5nIHRleHQgb2YgZ2l2ZW4gdmVyc2VzXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb3B5VmVyc2VNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIHVzZXJJbnB1dDogc3RyaW5nXHJcbiAgICBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkXHJcbiAgICBwbHVnaW5TZXR0aW5nczogUGx1Z2luU2V0dGluZ3M7XHJcbiAgICB0cmFuc2xhdGlvblBhdGg6IHN0cmluZztcclxuICAgIGxpbmtPbmx5OiBib29sZWFuO1xyXG5cclxuICAgIGhhbmRsZUlucHV0ID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldFRleHRPZlZlcnNlcyh0aGlzLmFwcCwgdGhpcy51c2VySW5wdXQsIHRoaXMucGx1Z2luU2V0dGluZ3MsIHRoaXMudHJhbnNsYXRpb25QYXRoLCB0aGlzLmxpbmtPbmx5KTtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB0aGlzLm9uU3VibWl0KHJlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgc2V0dGluZ3M6IFBsdWdpblNldHRpbmdzLCBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5wbHVnaW5TZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGxldCBwcmV2aWV3RWw6IEhUTUxUZXh0QXJlYUVsZW1lbnQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlZnJlc2hQcmV2aWV3ID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRQcmV2aWV3VGV4dChwcmV2aWV3RWwsIHRoaXMudXNlcklucHV0LCB0aGlzLnBsdWdpblNldHRpbmdzLCB0aGlzLnRyYW5zbGF0aW9uUGF0aCwgdGhpcy5saW5rT25seSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBBZGQgaGVhZGluZyBcclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiQ29weSB2ZXJzZSBieSBiaWJsZSByZWZlcmVuY2VcIiB9KTtcclxuXHJcbiAgICAgICAgLy8gQWRkIFRleHRib3ggZm9yIHJlZmVyZW5jZVxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJJbnNlcnQgcmVmZXJlbmNlXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB0ZXh0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51c2VySW5wdXQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIHJlZnJlc2hQcmV2aWV3KCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuaW5wdXRFbC5mb2N1cygpKTsgLy8gU2V0cyBmb2N1cyB0byBpbnB1dCBmaWVsZFxyXG5cclxuICAgICAgICAvLyBBZGQgdHJhbnNsYXRpb24gcGlja2VyXHJcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luU2V0dGluZ3MuZW5hYmxlTXVsdGlwbGVUcmFuc2xhdGlvbnMgJiYgdGhpcy5wbHVnaW5TZXR0aW5ncy50cmFuc2xhdGlvbnNQYXRocyAhPT0gXCJcIikge1xyXG4gICAgICAgICAgICBjb25zdCB0cmFuc2F0aW9uUGlja2VyID0gbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoXCJQaWNrIHRyYW5zbGF0aW9uXCIpXHJcblxyXG4gICAgICAgICAgICBsZXQgYnV0dG9uczogQnV0dG9uQ29tcG9uZW50W10gPSBbXTtcclxuICAgICAgICAgICAgbGV0IGJ1dHRvblBhdGhNYXAgPSBuZXcgTWFwPEJ1dHRvbkNvbXBvbmVudCwgc3RyaW5nPigpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luU2V0dGluZ3MucGFyc2VkVHJhbnNsYXRpb25QYXRocy5mb3JFYWNoKChwYXRoKSA9PiB7IC8vIGRpc3BsYXkgdHJhbnNsYXRpb24gYnV0dG9uc1xyXG4gICAgICAgICAgICAgICAgdHJhbnNhdGlvblBpY2tlclxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b25zLnB1c2goYnRuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uUGF0aE1hcC5zZXQoYnRuLCBwYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNwbGl0dGVkUGF0aCA9IHBhdGguc3BsaXQoXCIvXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidG4uc2V0QnV0dG9uVGV4dChzcGxpdHRlZFBhdGhbc3BsaXR0ZWRQYXRoLmxlbmd0aCAtIDJdKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgIGJ1dHRvbnMuZm9yRWFjaCgoYnRuKSA9PiB7IC8vIG1ha2Ugc3VyZSB0aGF0IG9ubHkgb25lIGlzIHNlbGVjdGVkIGF0IGEgdGltZVxyXG4gICAgICAgICAgICAgICAgICAgIGJ0bi5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9ucy5mb3JFYWNoKChiKSA9PiBiLnJlbW92ZUN0YSgpKTsgLy8gcmVtb3ZlIENUQSBmcm9tIGFsbCBidXR0b25zXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0bi5zZXRDdGEoKTsgLy8gc2V0IENUQSB0byB0aGlzIGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zbGF0aW9uUGF0aCA9IGJ1dHRvblBhdGhNYXAuZ2V0KGJ0bik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hQcmV2aWV3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcHJlc2VsZWN0IHRoZSBmaXJzdCBidXR0b24vdHJuYXNsYXRpb25cclxuICAgICAgICAgICAgICAgIGJ1dHRvbnMuZmlyc3QoKS5zZXRDdGEoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNsYXRpb25QYXRoID0gYnV0dG9uUGF0aE1hcC5nZXQoYnV0dG9ucy5maXJzdCgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBhZGQgbGluay1vbmx5IG9wdGlvbnNcclxuICAgICAgICB0aGlzLmxpbmtPbmx5ID0gdGhpcy5wbHVnaW5TZXR0aW5ncy5saW5rT25seTtcclxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTGluayBvbmx5XCIpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRnbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGdsLnNldFZhbHVlKHRoaXMucGx1Z2luU2V0dGluZ3MubGlua09ubHkpXHJcbiAgICAgICAgICAgICAgICB0Z2wub25DaGFuZ2UodmFsID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpbmtPbmx5ID0gdmFsO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlZnJlc2hQcmV2aWV3KCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyBBZGQgcHJldmlld1xyXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImxhYmVsXCIsIHsgdGV4dDogXCJQcmV2aWV3XCIgfSk7XHJcbiAgICAgICAgcHJldmlld0VsID0gY29udGVudEVsLmNyZWF0ZUVsKFwidGV4dGFyZWFcIiwgeyBjbHM6ICdjb3B5LXByZXZpZXcnLCBhdHRyOiB7IHJlYWRvbmx5OiB0cnVlIH0gfSk7XHJcblxyXG5cclxuICAgICAgICAvLyBBZGQgYnV0dG9uIGZvciBzdWJtaXQvZXhpdFxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBidG5cclxuICAgICAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dChcIkxpbmtcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0Q3RhKClcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljayh0aGlzLmhhbmRsZUlucHV0KVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gQWxsb3cgdXNlciB0byBleGl0IHVzaW5nIEVudGVyIGtleVxyXG4gICAgICAgIGNvbnRlbnRFbC5vbmtleWRvd24gPSAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFbnRlclwiKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVJbnB1dCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uQ2xvc2UoKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbiIsICJpbXBvcnQgeyBBcHAsIEhlYWRpbmdDYWNoZSwgTm90aWNlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBQbHVnaW5TZXR0aW5ncyB9IGZyb20gXCIuLi9tYWluXCI7XHJcbmltcG9ydCB7IGlzT0JTS0ZpbGUgfSBmcm9tIFwiLi4vdXRpbHMvcmVnZXhlc1wiO1xyXG5pbXBvcnQgeyBjYXBpdGFsaXplLCBnZXRGaWxlQnlGaWxlbmFtZSBhcyBnZXRURmlsZUJ5RmlsZW5hbWUsIHBhcnNlVXNlclZlcnNlSW5wdXQgfSBmcm9tIFwiLi9jb21tb25cIjtcclxuXHJcbi8qKlxyXG4gKiBDb252ZXJ0cyBiaWJsaWNhbCByZWZlcmVuY2UgdG8gdGV4dCBvZiBnaXZlbiB2ZXJzZXNcclxuICogQHBhcmFtIGFwcCBBcHAgaW5zdGFuY2VcclxuICogQHBhcmFtIHVzZXJJbnB1dCBVc2VyIElucHV0IChsaW5rIHRvIHZlcnNlKVxyXG4gKiBAcmV0dXJucyBTdHJpbmcgd2l0aCBxdW90ZSBvZiBsaW5rZWQgdmVyc2VzLiBJZiBjb252ZXJ0aW5nIHdhcyBub3Qgc3VjY2Vzc2Z1bCwgcmV0dXJucyBlbXB0eSBzdHJpbmcuXHJcbiAqIEB2ZXJib3NlIERldGVybWluZXMgaWYgTm90aWNlcyB3aWxsIGJlIHNob3duIG9yIG5vdFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFRleHRPZlZlcnNlcyhhcHA6IEFwcCwgdXNlcklucHV0OiBzdHJpbmcsIHNldHRpbmdzOiBQbHVnaW5TZXR0aW5ncywgdHJhbnNsYXRpb25QYXRoOiBzdHJpbmcsIGxpbmtPbmx5OiBib29sZWFuLCB2ZXJib3NlID0gdHJ1ZSk6IFByb21pc2U8c3RyaW5nPiB7XHJcblxyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1jb25zdFxyXG4gICAgbGV0IHsgYm9va0FuZENoYXB0ZXIsIGJlZ2luVmVyc2UsIGVuZFZlcnNlIH0gPSBwYXJzZVVzZXJWZXJzZUlucHV0KHVzZXJJbnB1dCwgdmVyYm9zZSk7XHJcbiAgICBib29rQW5kQ2hhcHRlciA9IGNhcGl0YWxpemUoYm9va0FuZENoYXB0ZXIpIC8vIEZvciBvdXRwdXQgY29uc2lzdGVuY3lcclxuICAgIGNvbnN0IHsgZmlsZU5hbWUsIHRGaWxlIH0gPSBnZXRURmlsZUJ5RmlsZW5hbWUoYXBwLCBib29rQW5kQ2hhcHRlciwgdHJhbnNsYXRpb25QYXRoKTtcclxuICAgIGlmICh0RmlsZSkge1xyXG4gICAgICAgIHJldHVybiBhd2FpdCBjcmVhdGVDb3B5T3V0cHV0KGFwcCwgdEZpbGUsIGZpbGVOYW1lLCBiZWdpblZlcnNlLCBlbmRWZXJzZSwgc2V0dGluZ3MsIHRyYW5zbGF0aW9uUGF0aCwgbGlua09ubHksIHZlcmJvc2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAodmVyYm9zZSkge1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKGBGaWxlICR7Ym9va0FuZENoYXB0ZXJ9IG5vdCBmb3VuZGApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBcIkZpbGUgbm90IGZvdW5kXCJcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgdGV4dCBvZiBnaXZlbiB2ZXJzZSB1c2luZyBnaXZlbiBoZWFkaW5ncyBhbmQgbGluZXMuXHJcbiAqIEBwYXJhbSB2ZXJzZU51bWJlciBOdW1iZXIgb2YgZGVzaXJlZCB2ZXJzZS5cclxuICogQHBhcmFtIGhlYWRpbmdzIExpc3Qgb2YgaGVhZGluZ3MgdGhhdCBzaG91bGQgYmUgc2VhcmNoZWQuIFNlY29uZCBoZWFkaW5nIG11c3QgY29ycmVzcG9uZCB0byBmaXJzdCB2ZXJzZSwgdGhpcmQgaGVhZGluZyB0byBzZWNvbmQgdmVyc2UgYW5kIHNvIG9uLlxyXG4gKiBAcGFyYW0gbGluZXMgTGluZXMgb2YgZmlsZSBmcm9tIHdoaWNoIHZlcnNlIHRleHQgc2hvdWxkIGJlIHRha2VuLlxyXG4gKiBAcGFyYW0ga2VlcE5ld2xpbmVzIElmIHNldCB0byB0cnVlLCB0ZXh0IHdpbGwgY29udGFpbiBuZXdsaW5lcyBpZiBwcmVzZW50IGluIHNvdXJjZSwgaWYgc2V0IHRvIGZhbHNlLCBuZXdsaW5lcyB3aWxsIGJlIGNoYW5nZWQgdG8gc3BhY2VzXHJcbiAqIEBwYXJhbSBuZXdMaW5lUHJlZml4IFByZWZpeCBmb3IgZWFjaCBsaW5lIG9mIHZlcnNlLCBpZiB2ZXJzZSBpcyBtdWx0aWxpbmUgYW5kIGtlZXBOZXdMaW5lcyA9IHRydWVcclxuICogQHJldHVybnMgVGV4dCBvZiBnaXZlbiB2ZXJzZS5cclxuICovXHJcbmZ1bmN0aW9uIGdldFZlcnNlVGV4dCh2ZXJzZU51bWJlcjogbnVtYmVyLCBoZWFkaW5nczogSGVhZGluZ0NhY2hlW10sIGxpbmVzOiBzdHJpbmdbXSwga2VlcE5ld2xpbmVzOiBib29sZWFuLCBuZXdMaW5lUHJlZml4OiBzdHJpbmcpIHtcclxuICAgIGlmICh2ZXJzZU51bWJlciA+PSBoZWFkaW5ncy5sZW5ndGgpIHsgLy8gb3V0IG9mIHJhbmdlXHJcbiAgICAgICAgbmV3IE5vdGljZShcIlZlcnNlIG91dCBvZiByYW5nZSBmb3IgZ2l2ZW4gZmlsZVwiKVxyXG4gICAgICAgIHRocm93IGBWZXJzZU51bWJlciAke3ZlcnNlTnVtYmVyfSBpcyBvdXQgb2YgcmFuZ2Ugb2YgaGVhZGluZ3Mgd2l0aCBsZW5ndGggJHtoZWFkaW5ncy5sZW5ndGh9YFxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGhlYWRpbmdMaW5lID0gaGVhZGluZ3NbdmVyc2VOdW1iZXJdLnBvc2l0aW9uLnN0YXJ0LmxpbmU7XHJcbiAgICBpZiAoaGVhZGluZ0xpbmUgKyAxID49IGxpbmVzLmxlbmd0aCkgeyAvLyBvdXQgb2YgcmFuZ2VcclxuICAgICAgICBuZXcgTm90aWNlKFwiTG9naWNhbCBlcnJvciAtIHBsZWFzZSBjcmVhdGUgaXNzdWUgb24gcGx1Z2luJ3MgR2l0SHViIHdpdGggeW91ciBpbnB1dCBhbmQgdGhlIGZpbGUgeW91IHdlcmUgcmVmZXJlbmNpbmcuIFRoYW5rIHlvdSFcIilcclxuICAgICAgICB0aHJvdyBgSGVhZGluZ0xpbmUgJHtoZWFkaW5nTGluZSArIDF9IGlzIG91dCBvZiByYW5nZSBvZiBsaW5lcyB3aXRoIGxlbmd0aCAke2xpbmVzfWBcclxuICAgIH1cclxuXHJcbiAgICAvLyBUaGlzIHBhcnQgaXMgbmVjZXNzYXJ5IGZvciB2ZXJzZXMgdGhhdCBzcGFuIG92ZXIgbXVsdGlwbGUgbGluZXNcclxuICAgIGxldCBvdXRwdXQgPSBcIlwiO1xyXG4gICAgbGV0IGxpbmUgPSBcIlwiO1xyXG4gICAgbGV0IGkgPSAxO1xyXG4gICAgbGV0IGlzRmlyc3QgPSB0cnVlO1xyXG5cclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zdGFudC1jb25kaXRpb25cclxuICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgbGluZSA9IGxpbmVzW2hlYWRpbmdMaW5lICsgaV07IC8vIGdldCBuZXh0IGxpbmVcclxuICAgICAgICBpZiAoL14jLy50ZXN0KGxpbmUpIHx8ICghbGluZSAmJiAhaXNGaXJzdCkpIHtcclxuICAgICAgICAgICAgYnJlYWs7IC8vIGhlYWRpbmcgbGluZSAobmV4dCB2ZXJzZSkgb3IgZW1wdHkgbGluZSBhZnRlciB2ZXJzZSA9PiBkbyBub3QgY29udGludWVcclxuICAgICAgICB9XHJcbiAgICAgICAgaSsrO1xyXG4gICAgICAgIGlmIChsaW5lKSB7IC8vIGlmIGxpbmUgaGFzIGNvbnRlbnQgKGlzIG5vdCBlbXB0eSBzdHJpbmcpXHJcbiAgICAgICAgICAgIGlmICghaXNGaXJzdCkgeyAvLyBJZiBpdCBpcyBub3QgZmlyc3QgbGluZSBvZiB0aGUgdmVyc2UsIGFkZCBkaXZpZGVyXHJcbiAgICAgICAgICAgICAgICBvdXRwdXQgKz0ga2VlcE5ld2xpbmVzID8gYFxcbiR7bmV3TGluZVByZWZpeH1gIDogXCIgXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaXNGaXJzdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBvdXRwdXQgKz0gbGluZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3V0cHV0O1xyXG59XHJcblxyXG4vKipcclxuICogUmVwbGFjZXMgXCJcXG5cIiB3aXRoIG5ld2xpbmUgY2hhcmFjdGVyIGluIGdpdmVuIHN0cmluZyAod2hlbiB1c2VyIGlucHV0cyBcIlxcblwiIGluIHRoZSBzZXR0aW5ncyBpdCBpcyBhdXRvbWF0aWNhbGx5IGNvbnZlcnRlZCB0byBcIlxcXFxuXCIgYW5kIGRvZXMgbm90IHdvcmsgYXMgbmV3bGluZSlcclxuICovXHJcbmZ1bmN0aW9uIHJlcGxhY2VOZXdsaW5lKGlucHV0OiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBpbnB1dC5yZXBsYWNlKC9cXFxcbi9nLCBcIlxcblwiLCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUYWtlcyBvcmdpbmFsIGZpbGVuYW1lIGFuZCBjb252ZXJ0cyBpdCB0byBodW1hbi1yZWFkYWJsZSB2ZXJzaW9uIGlmIEJpYmxlIHN0dWR5IGtpdCBpcyB1c2VkIChyZW1vdmVzIFwiLVwiIGFuZCBsZWFkaW5nIHplcm9zKVxyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlQm9va0FuZENoYXB0ZXJPdXRwdXQoZmlsZUJhc2VuYW1lOiBzdHJpbmcpIHtcclxuICAgIGlmIChpc09CU0tGaWxlLnRlc3QoZmlsZUJhc2VuYW1lKSkge1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItY29uc3RcclxuICAgICAgICBsZXQgWywgZmlsZW5hbWUsIGNoYXB0ZXJdID0gZmlsZUJhc2VuYW1lLm1hdGNoKGlzT0JTS0ZpbGUpO1xyXG4gICAgICAgIGlmIChjaGFwdGVyLnRvU3RyaW5nKClbMF0gPT09IFwiMFwiKSB7XHJcbiAgICAgICAgICAgIGNoYXB0ZXIgPSBjaGFwdGVyLnN1YnN0cmluZygxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZpbGVuYW1lICsgXCIgXCIgKyBjaGFwdGVyO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZpbGVCYXNlbmFtZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgcGF0aCB0byBmb2xkZXIgaW4gd2hpY2ggZ2l2ZW4gZmlsZSBpcyBsb2NhdGVkIGZvciBtYWluIHRyYW5zbGF0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRGaWxlRm9sZGVySW5UcmFuc2xhdGlvbihhcHA6IEFwcCwgZmlsZW5hbWU6IHN0cmluZywgdHJhbnNsYXRpb246IHN0cmluZykge1xyXG4gICAgY29uc3QgdEZpbGVJbmZvID0gZ2V0VEZpbGVCeUZpbGVuYW1lKGFwcCwgZmlsZW5hbWUsIHRyYW5zbGF0aW9uKTtcclxuICAgIHJldHVybiB0RmlsZUluZm8udEZpbGUucGFyZW50LnBhdGg7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNvcHlPdXRwdXQoYXBwOiBBcHAsIHRGaWxlOiBURmlsZSwgZmlsZU5hbWU6IHN0cmluZywgYmVnaW5WZXJzZTogbnVtYmVyLCBlbmRWZXJzZTogbnVtYmVyLCBzZXR0aW5nczogUGx1Z2luU2V0dGluZ3MsIHRyYW5zbGF0aW9uUGF0aDogc3RyaW5nLCBsaW5rT25seTogYm9vbGVhbiwgdmVyYm9zZTogYm9vbGVhbikge1xyXG4gICAgY29uc3QgYm9va0FuZENoYXB0ZXJPdXRwdXQgPSBjcmVhdGVCb29rQW5kQ2hhcHRlck91dHB1dCh0RmlsZS5iYXNlbmFtZSk7XHJcbiAgICBjb25zdCBmaWxlID0gYXBwLnZhdWx0LnJlYWQodEZpbGUpXHJcbiAgICBjb25zdCBsaW5lcyA9IChhd2FpdCBmaWxlKS5zcGxpdCgvXFxyP1xcbi8pXHJcbiAgICBjb25zdCB2ZXJzZUhlYWRpbmdMZXZlbCA9IHNldHRpbmdzLnZlcnNlSGVhZGluZ0xldmVsXHJcbiAgICBjb25zdCBoZWFkaW5ncyA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh0RmlsZSkuaGVhZGluZ3MuZmlsdGVyKGhlYWRpbmcgPT4gIXZlcnNlSGVhZGluZ0xldmVsIHx8IGhlYWRpbmcubGV2ZWwgPT09IHZlcnNlSGVhZGluZ0xldmVsKVxyXG4gICAgY29uc3QgYmVnaW5WZXJzZU5vT2Zmc2V0ID0gYmVnaW5WZXJzZVxyXG4gICAgYmVnaW5WZXJzZSArPSBzZXR0aW5ncy52ZXJzZU9mZnNldFxyXG4gICAgZW5kVmVyc2UgKz0gc2V0dGluZ3MudmVyc2VPZmZzZXRcclxuICAgIHZhciBuck9mVmVyc2VzID0gaGVhZGluZ3MubGVuZ3RoIC0gMTtcclxuICAgIHZhciBtYXhWZXJzZSA9IGVuZFZlcnNlIDwgbnJPZlZlcnNlcyA/IGVuZFZlcnNlIDogbnJPZlZlcnNlczsgLy8gaWYgZW5kdmVyc2UgaXMgYmlnZ2VyIHRoYW4gY2hhcHRlciBhbGxvd3MsIGl0IGlzIGxvd2VyZWQgdG8gbWF4aW11bVxyXG4gICAgdmFyIG1heFZlcnNlTm9PZmZzZXQgPSBtYXhWZXJzZSAtIHNldHRpbmdzLnZlcnNlT2Zmc2V0O1xyXG5cclxuXHJcbiAgICBpZiAoYmVnaW5WZXJzZSA+IG1heFZlcnNlKSB7XHJcbiAgICAgICAgaWYgKHZlcmJvc2UpIHtcclxuICAgICAgICAgICAgbmV3IE5vdGljZShcIkJlZ2luIHZlcnNlIGlzIGJpZ2dlciB0aGFuIGVuZCB2ZXJzZSBvciBjaGFwdGVyIG1heGltdW1cIilcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhyb3cgXCJCZWdpbiB2ZXJzZSBpcyBiaWdnZXIgdGhhbiBlbmQgdmVyc2Ugb3IgY2hhcHRlciBtYXhpbXVtXCJcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gMSAtIExpbmsgdG8gdmVyc2VzXHJcbiAgICBsZXQgcG9zdGZpeCA9IFwiXCIsIHJlcyA9IFwiXCIsIHBhdGhUb1VzZSA9IFwiXCI7XHJcbiAgICBpZiAoIWxpbmtPbmx5KSB7XHJcbiAgICAgICAgcmVzID0gc2V0dGluZ3MucHJlZml4O1xyXG4gICAgICAgIHBvc3RmaXggPSBzZXR0aW5ncy5wb3N0Zml4ID8gcmVwbGFjZU5ld2xpbmUoc2V0dGluZ3MucG9zdGZpeCkgOiBcIiBcIjtcclxuICAgIH1cclxuICAgIGlmIChzZXR0aW5ncy5lbmFibGVNdWx0aXBsZVRyYW5zbGF0aW9ucykge1xyXG4gICAgICAgIGlmIChzZXR0aW5ncy50cmFuc2xhdGlvbkxpbmtpbmdUeXBlICE9PSBcIm1haW5cIikgLy8gbGluayB0aGUgdHJhbnNsYXRpb24gdGhhdCBpcyBjdXJyZW50bHkgYmVpbmcgdXNlZFxyXG4gICAgICAgICAgICBwYXRoVG9Vc2UgPSBnZXRGaWxlRm9sZGVySW5UcmFuc2xhdGlvbihhcHAsIGZpbGVOYW1lLCB0cmFuc2xhdGlvblBhdGgpO1xyXG4gICAgICAgIGVsc2UgeyAvLyBsaW5rIG1haW4gdHJhbnNsYXRpb25cclxuICAgICAgICAgICAgcGF0aFRvVXNlID0gZ2V0RmlsZUZvbGRlckluVHJhbnNsYXRpb24oYXBwLCBmaWxlTmFtZSwgc2V0dGluZ3MucGFyc2VkVHJhbnNsYXRpb25QYXRocy5maXJzdCgpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGJlZ2luVmVyc2UgPT09IG1heFZlcnNlKSB7XHJcbiAgICAgICAgcmVzICs9IGBbWyR7cGF0aFRvVXNlID8gcGF0aFRvVXNlICsgXCIvXCIgOiBcIlwifSR7ZmlsZU5hbWV9IyR7aGVhZGluZ3NbYmVnaW5WZXJzZV0uaGVhZGluZ318JHtib29rQW5kQ2hhcHRlck91dHB1dH0ke3NldHRpbmdzLm9uZVZlcnNlTm90YXRpb259JHtiZWdpblZlcnNlTm9PZmZzZXR9XV0ke3Bvc3RmaXh9YCAvLyBbW0dlbiAxIzF8R2VuIDEsMS4xXV1cclxuICAgIH0gZWxzZSBpZiAoc2V0dGluZ3MubGlua0VuZFZlcnNlKSB7XHJcbiAgICAgICAgcmVzICs9IGBbWyR7cGF0aFRvVXNlID8gcGF0aFRvVXNlICsgXCIvXCIgOiBcIlwifSR7ZmlsZU5hbWV9IyR7aGVhZGluZ3NbYmVnaW5WZXJzZV0uaGVhZGluZ318JHtib29rQW5kQ2hhcHRlck91dHB1dH0ke3NldHRpbmdzLm11bHRpcGxlVmVyc2VzTm90YXRpb259JHtiZWdpblZlcnNlTm9PZmZzZXR9LV1dYCAvLyBbW0dlbiAxIzF8R2VuIDEsMS1dXVxyXG4gICAgICAgIHJlcyArPSBgW1ske3BhdGhUb1VzZSA/IHBhdGhUb1VzZSArIFwiL1wiIDogXCJcIn0ke2ZpbGVOYW1lfSMke2hlYWRpbmdzW21heFZlcnNlXS5oZWFkaW5nfXwke21heFZlcnNlTm9PZmZzZXR9XV0ke3Bvc3RmaXh9YDsgLy8gW1tHZW4gMSMzfDNdXVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXMgKz0gYFtbJHtwYXRoVG9Vc2UgPyBwYXRoVG9Vc2UgKyBcIi9cIiA6IFwiXCJ9JHtmaWxlTmFtZX0jJHtoZWFkaW5nc1tiZWdpblZlcnNlXS5oZWFkaW5nfXwke2Jvb2tBbmRDaGFwdGVyT3V0cHV0fSR7c2V0dGluZ3MubXVsdGlwbGVWZXJzZXNOb3RhdGlvbn0ke2JlZ2luVmVyc2VOb09mZnNldH0tJHttYXhWZXJzZU5vT2Zmc2V0fV1dJHtwb3N0Zml4fWAgLy8gW1tHZW4gMSMxfEdlbiAxLDEtM11dXHJcbiAgICB9XHJcblxyXG4gICAgLy8gMiAtIFRleHQgb2YgdmVyc2VzXHJcbiAgICBpZiAoIWxpbmtPbmx5KSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IGJlZ2luVmVyc2U7IGkgPD0gbWF4VmVyc2U7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgdmVyc2VQcmVmaXggPSBcIlwiO1xyXG4gICAgICAgICAgICBjb25zdCB2ZXJzZVBvc3RmaXggPSBzZXR0aW5ncy5pbnNlcnRTcGFjZSA/IFwiIFwiIDogXCJcIjtcclxuICAgICAgICAgICAgaWYgKHNldHRpbmdzLmVhY2hWZXJzZVByZWZpeCkge1xyXG4gICAgICAgICAgICAgICAgdmVyc2VQcmVmaXggKz0gc2V0dGluZ3MuZWFjaFZlcnNlUHJlZml4LnJlcGxhY2UoL3tufS9nLCAoaSAtIHNldHRpbmdzLnZlcnNlT2Zmc2V0KS50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgICAgIHZlcnNlUHJlZml4ID0gdmVyc2VQcmVmaXgucmVwbGFjZSgve2Z9L2csIGAke2ZpbGVOYW1lfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHZlcnNlVGV4dCA9IGdldFZlcnNlVGV4dChpLCBoZWFkaW5ncywgbGluZXMsIHNldHRpbmdzLm5ld0xpbmVzLCBzZXR0aW5ncy5wcmVmaXgpO1xyXG4gICAgICAgICAgICBpZiAoc2V0dGluZ3MubmV3TGluZXMpIHtcclxuICAgICAgICAgICAgICAgIHJlcyArPSBcIlxcblwiICsgc2V0dGluZ3MucHJlZml4ICsgdmVyc2VQcmVmaXggKyB2ZXJzZVRleHQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXMgKz0gdmVyc2VQcmVmaXggKyB2ZXJzZVRleHQgKyB2ZXJzZVBvc3RmaXg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMyAtIEludmlzaWJsZSBsaW5rc1xyXG4gICAgaWYgKCFzZXR0aW5ncy51c2VJbnZpc2libGVMaW5rcykgcmV0dXJuIHJlcztcclxuICAgIGlmIChiZWdpblZlcnNlID09IG1heFZlcnNlIC8vIE5vIG5lZWQgdG8gYWRkIGFub3RoZXIgbGluaywgd2hlbiBvbmx5IG9uZSB2ZXJzZSBpcyBiZWluZyBsaW5rZWRcclxuICAgICAgICAmJiAoIXNldHRpbmdzLmVuYWJsZU11bHRpcGxlVHJhbnNsYXRpb25zXHJcbiAgICAgICAgICAgIHx8IHNldHRpbmdzLnRyYW5zbGF0aW9uTGlua2luZ1R5cGUgPT09IFwibWFpblwiXHJcbiAgICAgICAgICAgIHx8IHNldHRpbmdzLnRyYW5zbGF0aW9uTGlua2luZ1R5cGUgPT09IFwidXNlZFwiKSkgLy8gT25seSBsaW5raW5nIG9uZSB0cmFuc2xhdGlvbiAtIGFscmVhZHkgbGlua2VkIFxyXG4gICAgICAgIHJldHVybiByZXM7XHJcblxyXG4gICAgaWYgKHNldHRpbmdzLm5ld0xpbmVzICYmICFsaW5rT25seSkge1xyXG4gICAgICAgIHJlcyArPSBgXFxuJHtzZXR0aW5ncy5wcmVmaXh9YDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBsYXN0VmVyc2VUb0xpbmsgPSBzZXR0aW5ncy5saW5rRW5kVmVyc2UgPyBtYXhWZXJzZSAtIDEgOiBtYXhWZXJzZTtcclxuICAgIGZvciAobGV0IGkgPSBiZWdpblZlcnNlICsgMTsgaSA8PSBsYXN0VmVyc2VUb0xpbms7IGkrKykgeyAvLyBiZWdpblZlcnNlICsgMSBiZWNhdXNlIGxpbmsgdG8gZmlyc3QgdmVyc2UgaXMgYWxyZWFkeSBpbnNlcnRlZCBiZWZvcmUgdGhlIHRleHRcclxuICAgICAgICBpZiAoIXNldHRpbmdzLmVuYWJsZU11bHRpcGxlVHJhbnNsYXRpb25zKSB7XHJcbiAgICAgICAgICAgIHJlcyArPSBgW1ske2ZpbGVOYW1lfSMke2hlYWRpbmdzW2ldLmhlYWRpbmd9fF1dYFxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHsgLy8gbXVsdGlwbGUgdHJhbnNsYXRpb25zIFxyXG4gICAgICAgICAgICBsZXQgdHJhbnNsYXRpb25QYXRoc1RvVXNlOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHNldHRpbmdzLnRyYW5zbGF0aW9uTGlua2luZ1R5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJhbGxcIjpcclxuICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblBhdGhzVG9Vc2UgPSBzZXR0aW5ncy5wYXJzZWRUcmFuc2xhdGlvblBhdGhzLm1hcCgodHIpID0+IGdldEZpbGVGb2xkZXJJblRyYW5zbGF0aW9uKGFwcCwgZmlsZU5hbWUsIHRyKSlcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJ1c2VkXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25QYXRoc1RvVXNlID0gW2dldEZpbGVGb2xkZXJJblRyYW5zbGF0aW9uKGFwcCwgZmlsZU5hbWUsIHRyYW5zbGF0aW9uUGF0aCldXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwidXNlZEFuZE1haW5cIjpcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHJhbnNsYXRpb25QYXRoICE9PSBzZXR0aW5ncy5wYXJzZWRUcmFuc2xhdGlvblBhdGhzLmZpcnN0KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25QYXRoc1RvVXNlID0gW2dldEZpbGVGb2xkZXJJblRyYW5zbGF0aW9uKGFwcCwgZmlsZU5hbWUsIHRyYW5zbGF0aW9uUGF0aCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldEZpbGVGb2xkZXJJblRyYW5zbGF0aW9uKGFwcCwgZmlsZU5hbWUsIHNldHRpbmdzLnBhcnNlZFRyYW5zbGF0aW9uUGF0aHMuZmlyc3QoKSldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25QYXRoc1RvVXNlID0gW2dldEZpbGVGb2xkZXJJblRyYW5zbGF0aW9uKGFwcCwgZmlsZU5hbWUsIHRyYW5zbGF0aW9uUGF0aCldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJtYWluXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25QYXRoc1RvVXNlID0gW2dldEZpbGVGb2xkZXJJblRyYW5zbGF0aW9uKGFwcCwgZmlsZU5hbWUsIHNldHRpbmdzLnBhcnNlZFRyYW5zbGF0aW9uUGF0aHMuZmlyc3QoKSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0cmFuc2xhdGlvblBhdGhzVG9Vc2UuZm9yRWFjaCgodHJhbnNsYXRpb25QYXRoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXMgKz0gYFtbJHt0cmFuc2xhdGlvblBhdGh9LyR7ZmlsZU5hbWV9IyR7aGVhZGluZ3NbaV0uaGVhZGluZ318XV1gXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuIiwgIi8qXHJcbiogUmVnZXhlcyBmb3IgdmVyc2UgcGFyc2luZ1xyXG4qL1xyXG5cclxuLy8gTGluayB0byBvbmUgdmVyc2UsIGZvciBleGFtcGxlIFwiR2VuIDEuMVwiIG9yIFwiR2VuIDE6MVwiXHJcbmV4cG9ydCBjb25zdCBvbmVWZXJzZVJlZ0V4ID0gbmV3IFJlZ0V4cCgvKFteLDojXSspWywjLjo7XVxccyooXFxkKylcXHMqJC8pO1xyXG5cclxuLy8gTGluayB0byBtdWx0aXBsZSB2ZXJzZXMsIGZvciBleGFtcGxlIFwiR2VuIDEsMS01XCJcclxuZXhwb3J0IGNvbnN0IG11bHRpcGxlVmVyc2VzUmVnRXggPSBuZXcgUmVnRXhwKC8oW14sOiNdKylbLCMuOjtdXFxzKihcXGQrKVxccypbLS49XVxccyooXFxkKylcXHMqJC8pO1xyXG5cclxuLy8gQm9vayBhbmQgY2hhcHRlciBzdHJpbmcgKHVzZWQgZm9yIGNvbnZlcnRpbmcgdG8gYmlibGUgc3R1ZHkga2l0IGZpbGUgbmFtZXMpXHJcbmV4cG9ydCBjb25zdCBib29rQW5kQ2hhcHRlclJlZ2V4Rm9yT0JTSyA9IC8oW14sOiNdKylcXHMoXFxkKykvXHJcblxyXG4vLyBNdWx0aXBsZSBjaGFwdGVycywgZm9yIGV4YW1wbGUgXCJHZW4gMS0zXCJcclxuZXhwb3J0IGNvbnN0IG11bHRpcGxlQ2hhcHRlcnMgPSAvKFxcZCpbXlxcZCw6I10rKVxccyooXFxkKylcXHMqLVxccyooXFxkKylcXHMqJC9cclxuXHJcbi8vIENhbiBiZSB1c2VkIHRvIGRldGVybWluZSB3aGV0aGVyIGdpdmVuIG5hbWUgb2YgZmlsZSBpcyBmcm9tIE9CU0sgKGZvciBleGFtcGxlIEdlbi0wMSlcclxuZXhwb3J0IGNvbnN0IGlzT0JTS0ZpbGUgPSAvKFtBLXpcdTAwQzAtXHUwMTdFMC05IF0rKS0oXFxkezIsM30pL1xyXG4iLCAiLypcclxuICogQ2FwaXRhbGl6ZXMgZ2l2ZW4gc3RyaW5nIChza2lwcyBsZWFkaW5nIHdoaXRlc3BhY2VzIGFuZCBudW1iZXJzKVxyXG4gKi9cclxuaW1wb3J0IHsgYm9va0FuZENoYXB0ZXJSZWdleEZvck9CU0ssIG11bHRpcGxlQ2hhcHRlcnMsIG11bHRpcGxlVmVyc2VzUmVnRXgsIG9uZVZlcnNlUmVnRXggfSBmcm9tIFwiLi4vdXRpbHMvcmVnZXhlc1wiO1xyXG5pbXBvcnQgeyBBcHAsIE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuLyoqXHJcbiAqIENhcGl0YWxpemVzIGdpdmVuIHN0cmluZywgdGFraW5nIGxlYWRpbmcgbnVtYmVycyBpbnRvIGFjY291bnRcclxuICogQHBhcmFtIHN0ciBTdHJpbmcgdGhhdCBzaG91bGQgYmUgY2FwaXRhbGl6ZWRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjYXBpdGFsaXplKHN0cjogc3RyaW5nKSB7XHJcbiAgICBzdHIgPSBzdHIudG9Mb2NhbGVMb3dlckNhc2UoKTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgaWYgKC9bXlxcc1xcZC4sIy1dLy50ZXN0KHN0ci5jaGFyQXQoaSkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzdHIuc2xpY2UoMCwgaSkgKyBzdHIuY2hhckF0KGkpLnRvVXBwZXJDYXNlKCkgKyBzdHIuc2xpY2UoaSArIDEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBzdHI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBQYXJzZXMgaW5wdXQgZnJvbSB1c2VyLCBleHBlY3RpbmcgY2hhcHRlciBhbmQgdmVyc2VzXHJcbiAqIEBwYXJhbSB1c2VySW5wdXRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVVzZXJWZXJzZUlucHV0KHVzZXJJbnB1dDogc3RyaW5nLCB2ZXJib3NlID0gdHJ1ZSkge1xyXG4gICAgbGV0IGJvb2tBbmRDaGFwdGVyO1xyXG4gICAgbGV0IGJlZ2luVmVyc2U7XHJcbiAgICBsZXQgZW5kVmVyc2U7XHJcblxyXG4gICAgc3dpdGNoICh0cnVlKSB7XHJcbiAgICAgICAgY2FzZSBvbmVWZXJzZVJlZ0V4LnRlc3QodXNlcklucHV0KTogeyAvLyBvbmUgdmVyc2VcclxuICAgICAgICAgICAgY29uc3QgWywgbWF0Y2hlZENoYXB0ZXIsIG1hdGNoZWRWZXJzZV0gPSB1c2VySW5wdXQubWF0Y2gob25lVmVyc2VSZWdFeClcclxuICAgICAgICAgICAgYm9va0FuZENoYXB0ZXIgPSBtYXRjaGVkQ2hhcHRlcjtcclxuICAgICAgICAgICAgYmVnaW5WZXJzZSA9IE51bWJlcihtYXRjaGVkVmVyc2UpO1xyXG4gICAgICAgICAgICBlbmRWZXJzZSA9IE51bWJlcihtYXRjaGVkVmVyc2UpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FzZSBtdWx0aXBsZVZlcnNlc1JlZ0V4LnRlc3QodXNlcklucHV0KTogeyAvLyBtdWx0aXBsZSB2ZXJzZXMsIG9uZSBjaGFwdGVyXHJcbiAgICAgICAgICAgIGNvbnN0IFssIG1hdGNoZWRDaGFwdGVyLCBtYXRjaGVkQmVnaW5WZXJzZSwgbWF0Y2hlZEVuZFZlcnNlXSA9IHVzZXJJbnB1dC5tYXRjaChtdWx0aXBsZVZlcnNlc1JlZ0V4KVxyXG4gICAgICAgICAgICBib29rQW5kQ2hhcHRlciA9IG1hdGNoZWRDaGFwdGVyO1xyXG4gICAgICAgICAgICBiZWdpblZlcnNlID0gTnVtYmVyKG1hdGNoZWRCZWdpblZlcnNlKTtcclxuICAgICAgICAgICAgZW5kVmVyc2UgPSBOdW1iZXIobWF0Y2hlZEVuZFZlcnNlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRlZmF1bHQ6IHtcclxuICAgICAgICAgICAgaWYgKHZlcmJvc2UpIHtcclxuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFdyb25nIGZvcm1hdCBcIiR7dXNlcklucHV0fVwiYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhyb3cgXCJDb3VsZCBub3QgcGFyc2UgdXNlciBpbnB1dFwiXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7IGJvb2tBbmRDaGFwdGVyLCBiZWdpblZlcnNlLCBlbmRWZXJzZSB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBQYXJzZXMgaW5wdXQgZnJvbSB1c2VyLCBleHBlY3RpbmcgbXVsdGlwbGUgY2hhcHRlcnNcclxuICogQHBhcmFtIHVzZXJJbnB1dFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlVXNlckJvb2tJbnB1dCh1c2VySW5wdXQ6IHN0cmluZykge1xyXG4gICAgbGV0IGJvb2s7XHJcbiAgICBsZXQgZmlyc3RDaGFwdGVyO1xyXG4gICAgbGV0IGxhc3RDaGFwdGVyO1xyXG5cclxuICAgIHN3aXRjaCAodHJ1ZSkge1xyXG4gICAgICAgIGNhc2UgbXVsdGlwbGVDaGFwdGVycy50ZXN0KHVzZXJJbnB1dCk6IHsgLy8gb25lIHZlcnNlXHJcbiAgICAgICAgICAgIGNvbnN0IFssIG1hdGNoZWRCb29rLCBtYXRjaGVkRmlyc3RDaGFwdGVyLCBtYXRjaGVkTGFzdENoYXB0ZXJdID0gdXNlcklucHV0Lm1hdGNoKG11bHRpcGxlQ2hhcHRlcnMpXHJcbiAgICAgICAgICAgIGJvb2sgPSBtYXRjaGVkQm9vay50cmltKCk7XHJcbiAgICAgICAgICAgIGZpcnN0Q2hhcHRlciA9IE51bWJlcihtYXRjaGVkRmlyc3RDaGFwdGVyKTtcclxuICAgICAgICAgICAgbGFzdENoYXB0ZXIgPSBOdW1iZXIobWF0Y2hlZExhc3RDaGFwdGVyKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRlZmF1bHQ6IHtcclxuICAgICAgICAgICAgbmV3IE5vdGljZShgV3JvbmcgZm9ybWF0IFwiJHt1c2VySW5wdXR9XCJgKTtcclxuICAgICAgICAgICAgdGhyb3cgXCJDb3VsZCBub3QgcGFyc2UgdXNlciBpbnB1dFwiXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7IGJvb2ssIGZpcnN0Q2hhcHRlciwgbGFzdENoYXB0ZXIgfVxyXG59XHJcblxyXG4vKipcclxuICogVHJpZXMgdG8gZ2V0IHRGaWxlIGNvcnJlc3BvbmRpbmcgdG8gZ2l2ZW4gZmlsZW5hbWUuIElmIHRoZSBmaWxlIGlzIG5vdCBmb3VuZCwgZmlsZW5hbWUgaXMgY29udmVydGVkIHRvIG1hdGNoIE9ic2lkaWFuXHJcbiAqIEJpYmxlIFN0dWR5IEtpdCBuYW1pbmcgY29udmVudGlvbiBhbmQgdGhlIG9wZXJhdGlvbiBpcyByZXBlYXRlZC5cclxuICogQHBhcmFtIGFwcFxyXG4gKiBAcGFyYW0gZmlsZW5hbWUgTmFtZSBvZiBmaWxlIHRoYXQgc2hvdWxkIGJlIHNlYXJjaGVkXHJcbiAqIEBwYXJhbSBwYXRoIFBhdGggd2hlcmUgdGhlIHNlYXJjaCBzaG91bGQgb2NjdXJlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmlsZUJ5RmlsZW5hbWUoYXBwOiBBcHAsIGZpbGVuYW1lOiBzdHJpbmcsIHBhdGggPSBcIi9cIikge1xyXG4gICAgbGV0IGZpbGVuYW1lQ29weSA9IGZpbGVuYW1lO1xyXG4gICAgbGV0IHRGaWxlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QoZmlsZW5hbWVDb3B5LCBwYXRoKVxyXG4gICAgaWYgKCF0RmlsZSkgeyAvLyBoYW5kbGUgXCJCaWJsZSBzdHVkeSBraXRcIiBmaWxlIG5hbWluZywgZWcuIEdlbi0wMSBpbnN0ZWFkIG9mIEdlbiAxXHJcbiAgICAgICAgZmlsZW5hbWVDb3B5ID0gdHJ5Q29udmVydFRvT0JTS0ZpbGVOYW1lKGZpbGVuYW1lQ29weSk7XHJcbiAgICAgICAgdEZpbGUgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChmaWxlbmFtZUNvcHksIHBhdGgpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHsgZmlsZU5hbWU6IGZpbGVuYW1lQ29weSwgdEZpbGUgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRyaWVzIHRvIGNvbnZlcnQgZmlsZSBuYW1lIHRvIE9ic2lkaWFuIFN0dWR5IEtpdCBmaWxlIG5hbWVcclxuICogQHBhcmFtIGJvb2tBbmRDaGFwdGVyIEZpbGUgbmFtZSB0aGF0IHNob3VsZCBiZSBjb252ZXJ0ZWRcclxuICogQHJldHVybnMgZmlsZSBuYW1lIGluIE9ic2lkYWluIFN0dWR5IEtpdCBuYW1pbmcgc3lzdGVtXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdHJ5Q29udmVydFRvT0JTS0ZpbGVOYW1lKGJvb2tBbmRDaGFwdGVyOiBzdHJpbmcpIHtcclxuICAgIGlmIChib29rQW5kQ2hhcHRlclJlZ2V4Rm9yT0JTSy50ZXN0KGJvb2tBbmRDaGFwdGVyKSkgeyAvLyBWYWxpZCBjaGFwdGVyIG5hbWVcclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWNvbnN0XHJcbiAgICAgICAgbGV0IFssIGJvb2ssIG51bWJlcl0gPSBib29rQW5kQ2hhcHRlci5tYXRjaChib29rQW5kQ2hhcHRlclJlZ2V4Rm9yT0JTSyk7XHJcbiAgICAgICAgaWYgKG51bWJlci5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgICAgICBudW1iZXIgPSBgMCR7bnVtYmVyfWBcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGAke2Jvb2t9LSR7bnVtYmVyfWBcclxuICAgIH1cclxufVxyXG4iLCAiXHJcbmltcG9ydCB7IEFwcCwgTW9kYWwsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgUGx1Z2luU2V0dGluZ3MgfSBmcm9tIFwiLi4vbWFpblwiO1xyXG5pbXBvcnQgeyBjcmVhdGVMaW5rcyB9IGZyb20gXCIuLi9sb2dpYy9saW5rLWNvbW1hbmRcIjtcclxuXHJcbmV4cG9ydCBlbnVtIExpbmtUeXBlIHtcclxuICAgIEJhc2ljID0gXCJCYXNpY1wiLFxyXG4gICAgRW1iZWRkZWQgPSBcIkVtYmVkZGVkXCIsXHJcbiAgICBJbnZpc2libGUgPSBcIkludmlzaWJsZVwiLFxyXG59XHJcblxyXG4vKipcclxuICogTW9kYWwgdGhhdCBsZXRzIHlvdSBpbnNlcnQgYmlibGUgcmVmZXJlbmNlIGJ5IHVzaW5nIE9ic2lkaWFuIGxpbmtzIFxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGlua1ZlcnNlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICB1c2VySW5wdXQ6IHN0cmluZztcclxuICAgIGxpbmtUeXBlOiBMaW5rVHlwZTtcclxuICAgIHVzZU5ld0xpbmU6IGJvb2xlYW47XHJcbiAgICBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkO1xyXG4gICAgcGx1Z2luU2V0dGluZ3M6IFBsdWdpblNldHRpbmdzO1xyXG5cclxuICAgIGhhbmRsZUlucHV0ID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGNyZWF0ZUxpbmtzKHRoaXMuYXBwLCB0aGlzLnVzZXJJbnB1dCwgdGhpcy5saW5rVHlwZSwgdGhpcy51c2VOZXdMaW5lLCB0aGlzLnBsdWdpblNldHRpbmdzKVxyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIHRoaXMub25TdWJtaXQocmVzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHNldHRpbmdzOiBQbHVnaW5TZXR0aW5ncywgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZCkge1xyXG4gICAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgICAgdGhpcy5vblN1Ym1pdCA9IG9uU3VibWl0O1xyXG4gICAgICAgIHRoaXMucGx1Z2luU2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgICAgICB0aGlzLmxpbmtUeXBlID0gdGhpcy5wbHVnaW5TZXR0aW5ncy5saW5rVHlwZVByZXNldDtcclxuICAgICAgICB0aGlzLnVzZU5ld0xpbmUgPSB0aGlzLnBsdWdpblNldHRpbmdzLm5ld0xpbmVQcmVzZXQ7XHJcbiAgICB9XHJcblxyXG4gICAgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG5cclxuICAgICAgICAvLyBBZGQgaGVhZGluZyBcclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiQ3JlYXRlIE9ic2lkaWFuIGxpbmtzIGZyb20gQmlibGUgcmVmZXJlbmNlXCIgfSk7XHJcblxyXG4gICAgICAgIC8vIEFkZCBUZXh0Ym94IGZvciByZWZlcmVuY2VcclxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiSW5zZXJ0IHJlZmVyZW5jZVwiKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5vbkNoYW5nZSgodmFsdWUpID0+IHsgdGhpcy51c2VySW5wdXQgPSB2YWx1ZSB9KVxyXG4gICAgICAgICAgICAgICAgLmlucHV0RWwuZm9jdXMoKSk7IC8vIFNldHMgZm9jdXMgdG8gaW5wdXQgZmllbGRcclxuXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJMaW5rIHR5cGVcIilcclxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChkcm9wZG93bikgPT4ge1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKExpbmtUeXBlLkJhc2ljLCBMaW5rVHlwZS5CYXNpYylcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihMaW5rVHlwZS5FbWJlZGRlZCwgTGlua1R5cGUuRW1iZWRkZWQpXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oTGlua1R5cGUuSW52aXNpYmxlLCBMaW5rVHlwZS5JbnZpc2libGUpXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5vbkNoYW5nZSgodmFsdWUpID0+IHRoaXMubGlua1R5cGUgPSB2YWx1ZSBhcyBMaW5rVHlwZSlcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKHRoaXMucGx1Z2luU2V0dGluZ3MubGlua1R5cGVQcmVzZXQpXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJFYWNoIGxpbmsgb24gbmV3IGxpbmU/XCIpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRnbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGdsLnNldFZhbHVlKHRoaXMucGx1Z2luU2V0dGluZ3MubmV3TGluZVByZXNldClcclxuICAgICAgICAgICAgICAgIHRnbC5vbkNoYW5nZSh2YWwgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXNlTmV3TGluZSA9IHZhbDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIClcclxuXHJcblxyXG4gICAgICAgIC8vIEFkZCBidXR0b24gZm9yIHN1Ym1pdC9leGl0XHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAgICAgICAuYWRkQnV0dG9uKChidG4pID0+IHtcclxuICAgICAgICAgICAgICAgIGJ0blxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiTGlua1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKHRoaXMuaGFuZGxlSW5wdXQpXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBBbGxvdyB1c2VyIHRvIGV4aXQgdXNpbmcgRW50ZXIga2V5XHJcbiAgICAgICAgY29udGVudEVsLm9ua2V5ZG93biA9IChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVudGVyXCIpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUlucHV0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25DbG9zZSgpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICAgIH1cclxufVxyXG5cclxuIiwgImltcG9ydCB7QXBwLCBOb3RpY2V9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQge0xpbmtUeXBlfSBmcm9tIFwiLi4vbW9kYWxzL2xpbmstdmVyc2UtbW9kYWxcIjtcclxuaW1wb3J0IHtQbHVnaW5TZXR0aW5nc30gZnJvbSBcIi4uL21haW5cIjtcclxuaW1wb3J0IHttdWx0aXBsZUNoYXB0ZXJzfSBmcm9tIFwiLi4vdXRpbHMvcmVnZXhlc1wiO1xyXG5pbXBvcnQge2NhcGl0YWxpemUsIGdldEZpbGVCeUZpbGVuYW1lLCBwYXJzZVVzZXJCb29rSW5wdXQsIHBhcnNlVXNlclZlcnNlSW5wdXR9IGZyb20gXCIuL2NvbW1vblwiO1xyXG5cclxuLyoqXHJcbiAqIENvbnZlcnRzIGJpYmxpY2FsIHJlZmVyZW5jZSB0byBsaW5rcyB0byBnaXZlbiB2ZXJzZXMgb3IgYm9va3NcclxuICogQHBhcmFtIGFwcCBBcHAgaW5zdGFuY2VcclxuICogQHBhcmFtIHVzZXJJbnB1dCBVc2VyIElucHV0IChsaW5rIHRvIHZlcnNlIG9yIGNoYXB0ZXIpXHJcbiAqIEBwYXJhbSBsaW5rVHlwZSBUeXBlIG9mIGxpbmsgdGhhdCBzaG91bGQgYmUgdXNlZFxyXG4gKiBAcGFyYW0gdXNlTmV3TGluZSBXaGV0aGVyIG9yIG5vdCBzaG91bGQgZWFjaCBsaW5rIGJlIG9uIG5ldyBsaW5lXHJcbiAqIEByZXR1cm5zIFN0cmluZyB3aXRoIHF1b3RlIG9mIGxpbmtlZCB2ZXJzZXMuIElmIGNvbnZlcnRpbmcgd2FzIG5vdCBzdWNjZXNzZnVsLCByZXR1cm5zIGVtcHR5IHN0cmluZy5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVMaW5rcyhhcHA6IEFwcCwgdXNlcklucHV0OiBzdHJpbmcsIGxpbmtUeXBlOiBMaW5rVHlwZSwgdXNlTmV3TGluZTogYm9vbGVhbiwgc2V0dGluZ3M6IFBsdWdpblNldHRpbmdzKSB7XHJcblx0aWYgKG11bHRpcGxlQ2hhcHRlcnMudGVzdCh1c2VySW5wdXQpKSB7XHJcblx0XHRyZXR1cm4gZ2V0TGlua3NGb3JDaGFwdGVycyhhcHAsIHVzZXJJbnB1dCwgbGlua1R5cGUsIHVzZU5ld0xpbmUsIHNldHRpbmdzKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0cmV0dXJuIGdldExpbmtzRm9yVmVyc2VzKGFwcCwgdXNlcklucHV0LCBsaW5rVHlwZSwgdXNlTmV3TGluZSwgc2V0dGluZ3MpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZXMgY29weSBjb21tYW5kIG91dHB1dCB3aGVuIGxpbmtpbmcgbXVsdGlwbGUgdmVyc2VzXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBnZXRMaW5rc0ZvclZlcnNlcyhhcHA6IEFwcCwgdXNlcklucHV0OiBzdHJpbmcsIGxpbmtUeXBlOiBMaW5rVHlwZSwgdXNlTmV3TGluZTogYm9vbGVhbiwgc2V0dGluZ3M6IFBsdWdpblNldHRpbmdzKSB7XHJcblx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1jb25zdFxyXG5cdGxldCB7Ym9va0FuZENoYXB0ZXIsIGJlZ2luVmVyc2UsIGVuZFZlcnNlfSA9IHBhcnNlVXNlclZlcnNlSW5wdXQodXNlcklucHV0KTtcclxuXHRib29rQW5kQ2hhcHRlciA9IGNhcGl0YWxpemUoYm9va0FuZENoYXB0ZXIpIC8vIEZvciBvdXRwdXQgY29uc2lzdGVuY3lcclxuXHRpZiAoc2V0dGluZ3MudmVyaWZ5RmlsZXNXaGVuTGlua2luZykge1xyXG5cdFx0Y29uc3Qge2ZpbGVOYW1lLCB0RmlsZX0gPSBnZXRGaWxlQnlGaWxlbmFtZShhcHAsIGJvb2tBbmRDaGFwdGVyKTtcclxuXHRcdGlmICghdEZpbGUpIHtcclxuXHRcdFx0bmV3IE5vdGljZShgRmlsZSBcIiR7ZmlsZU5hbWV9XCIgZG9lcyBub3QgZXhpc3QgYW5kIHZlcmlmeSBmaWxlcyBpcyBzZXQgdG8gdHJ1ZWApO1xyXG5cdFx0XHR0aHJvdyBgRmlsZSAke2ZpbGVOYW1lfSBkb2VzIG5vdCBleGlzdCwgdmVyaWZ5IGZpbGVzID0gdHJ1ZWA7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRpZiAoYmVnaW5WZXJzZSA+IGVuZFZlcnNlKSB7XHJcblx0XHRuZXcgTm90aWNlKFwiQmVnaW4gdmVyc2UgaXMgYmlnZ2VyIHRoYW4gZW5kIHZlcnNlXCIpXHJcblx0XHR0aHJvdyBcIkJlZ2luIHZlcnNlIGlzIGJpZ2dlciB0aGFuIGVuZCB2ZXJzZVwiXHJcblx0fVxyXG5cclxuXHRsZXQgcmVzID0gXCJcIjtcclxuXHRjb25zdCBiZWdpbm5pbmcgPSBsaW5rVHlwZSA9PT0gTGlua1R5cGUuRW1iZWRkZWQgPyBcIiFcIiA6IFwiXCI7XHJcblx0Y29uc3QgZW5kaW5nID0gbGlua1R5cGUgPT09IExpbmtUeXBlLkludmlzaWJsZSA/IFwifFwiIDogXCJcIjtcclxuXHRmb3IgKGxldCBpID0gYmVnaW5WZXJzZTsgaSA8PSBlbmRWZXJzZTsgaSsrKSB7XHJcblx0XHRyZXMgKz0gYCR7YmVnaW5uaW5nfVtbJHtib29rQW5kQ2hhcHRlcn0ke3NldHRpbmdzLmxpbmtTZXBhcmF0b3J9JHtzZXR0aW5ncy52ZXJzZVByZWZpeH0ke2l9JHtlbmRpbmd9XV1gXHJcblx0XHRpZiAodXNlTmV3TGluZSkge1xyXG5cdFx0XHRyZXMgKz0gJ1xcbidcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIHJlcztcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZXMgY29weSBjb21tYW5kIG91dHB1dCB3aGVuIGxpbmtpbmcgbXVsdGlwbGUgY2hhcHRlcnNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGdldExpbmtzRm9yQ2hhcHRlcnMoYXBwOiBBcHAsIHVzZXJJbnB1dDogc3RyaW5nLCBsaW5rVHlwZTogTGlua1R5cGUsIHVzZU5ld0xpbmU6IGJvb2xlYW4sIHNldHRpbmdzOiBQbHVnaW5TZXR0aW5ncykge1xyXG5cdGNvbnN0IHtib29rLCBmaXJzdENoYXB0ZXIsIGxhc3RDaGFwdGVyfSA9IHBhcnNlVXNlckJvb2tJbnB1dCh1c2VySW5wdXQpO1xyXG5cdGlmIChmaXJzdENoYXB0ZXIgPiBsYXN0Q2hhcHRlcikge1xyXG5cdFx0bmV3IE5vdGljZShcIkJlZ2luIGNoYXB0ZXIgaXMgYmlnZ2VyIHRoYW4gZW5kIGNoYXB0ZXJcIilcclxuXHRcdHRocm93IFwiQmVnaW4gY2hhcHRlciBpcyBiaWdnZXIgdGhhbiBlbmQgY2hhcHRlclwiXHJcblx0fVxyXG5cclxuXHRsZXQgcmVzID0gXCJcIjtcclxuXHRmb3IgKGxldCBpID0gZmlyc3RDaGFwdGVyOyBpIDw9IGxhc3RDaGFwdGVyOyBpKyspIHtcclxuXHRcdHJlcyArPSBgW1ske2Jvb2t9ICR7aX1dXWBcclxuXHRcdGlmICh1c2VOZXdMaW5lKSB7XHJcblx0XHRcdHJlcyArPSAnXFxuJ1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gcmVzO1xyXG59XHJcbiIsICJpbXBvcnQgeyBBcHAsIE5vdGljZSwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgQmlibGVMaW5rZXJQbHVnaW4gZnJvbSBcIi4vbWFpblwiO1xyXG5pbXBvcnQgeyBMaW5rVHlwZSB9IGZyb20gXCIuL21vZGFscy9saW5rLXZlcnNlLW1vZGFsXCI7XHJcbmltcG9ydCB7IExpbmtUeXBlIGFzIENvcHlMaW5rVHlwZSB9IGZyb20gXCIuL21vZGFscy9jb3B5LXZlcnNlLW1vZGFsXCI7XHJcblxyXG4vKipcclxuICogU2V0dGluZ3MgZm9yIHBsdWdpblxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgICBwbHVnaW46IEJpYmxlTGlua2VyUGx1Z2luO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEJpYmxlTGlua2VyUGx1Z2luKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgfVxyXG5cclxuICAgIGRpc3BsYXkoKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiQ29weSBhbmQgTGluayBCaWJsZSB2ZXJzZXMgY29tbWFuZFwiIH0pO1xyXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDRcIiwgeyB0ZXh0OiBcIkZ1bmN0aW9uYWxcIiB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiVmVyc2Ugb2Zmc2V0XCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdDaGFuZ2UgdGhpcyBpZiB3cm9uZyB2ZXJzZXMgYXJlIGJlaW5nIGxpbmtlZCwgZS5nLiB5b3Ugd2FudCBcIkdlbiAxLDEtM1wiIGJ1dCBvdXRwdXQgaXMgdGV4dCBmcm9tIHZlcnNlcyAyLTQgXHUyMTkyIHNldCB0aGlzIHRvIC0xJylcclxuICAgICAgICAgICAgLnNldENsYXNzKFwiaW1wb3J0YW50LXNldHRpbmdcIilcclxuICAgICAgICAgICAgLmFkZFRleHQoKGlucHV0Qm94KSA9PlxyXG4gICAgICAgICAgICAgICAgaW5wdXRCb3hcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyc2VPZmZzZXQudG9TdHJpbmcoKSlcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG51bWJlciA9IE51bWJlci5wYXJzZUludCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gXCItXCIpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE51bWJlci5pc05hTihudW1iZXIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiSW52YWxpZCBpbnB1dCwgcGxlYXNlIGluc2VydCB2YWxpZCBpbnRlZ2VyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRCb3guc2V0VmFsdWUoXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyc2VPZmZzZXQgPSBudW1iZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiVmVyc2UgaGVhZGluZyBsZXZlbFwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnSWYgc2V0LCBvbmx5IGhlYWRpbmdzIG9mIHNwZWNpZmllZCBsZXZlbCBhcmUgY29uc2lkZXJlZCB2ZXJzZXMgKGlmIGZpcnN0IGhlYWRpbmcgb2YgdGhpcyBsZXZlbCBpcyBhbHdheXMgYSB2ZXJzZSwgYWxzbyBzZXQgXCJWZXJzZSBvZmZzZXRcIiB0byAtMSknKVxyXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJhbnlcIiwgXCJhbnlcIilcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcIjZcIiwgXCIjIyMjIyNcIilcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcIjVcIiwgXCIjIyMjI1wiKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiNFwiLCBcIiMjIyNcIilcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcIjNcIiwgXCIjIyNcIilcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcIjJcIiwgXCIjI1wiKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKFwiMVwiLCBcIiNcIilcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnZlcnNlSGVhZGluZ0xldmVsPy50b1N0cmluZygpID8/IFwiYW55XCIpXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy52ZXJzZUhlYWRpbmdMZXZlbCA9IHZhbHVlID09PSBcImFueVwiID8gdW5kZWZpbmVkIDogTnVtYmVyKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDRcIiwgeyB0ZXh0OiBcIkluc2VydGVkIHByZWZpeGVzL3Bvc3RmaXhlc1wiIH0pO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJMaW5lIHByZWZpeFwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlN0cmluZyBpbnNlcnRlZCBpbiBmcm9udCBvZiBldmVyeSBsaW5lLCBmb3IgZXhhbXBsZSAnPicgZm9yIHF1b3RlLiBOb3RlOiBJZiB5b3Ugc2V0ICdQdXQgZWFjaCB2ZXJzZSBvbiBhIG5ldyBsaW5lPycgdG8gdHJ1ZSwgdGhlIHByZWZpeCB3aWxsIGJlIGluc2VydGVkIGluIGZyb250IG9mIGV2ZXJ5IGxpbmUuXCIpXHJcbiAgICAgICAgICAgIC5zZXRDbGFzcyhcImltcG9ydGFudC1zZXR0aW5nXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KChpbnB1dEJveCkgPT5cclxuICAgICAgICAgICAgICAgIGlucHV0Qm94XHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiSW5zZXJ0IHByZWZpeCBoZXJlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByZWZpeClcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByZWZpeCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkxpbmsgcG9zdGZpeFwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlN0cmluZyBpbnNlcnRlZCBhZnRlciBiaWJsaWNhbCBsaW5rLCB5b3UgY2FuIHVzZSBcXFxcbiB0byBpbnNlcnQgbmV3bGluZS5cIilcclxuICAgICAgICAgICAgLmFkZFRleHQoKGlucHV0Qm94KSA9PlxyXG4gICAgICAgICAgICAgICAgaW5wdXRCb3hcclxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJJbnNlcnQgcG9zdGZpeCBoZXJlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnBvc3RmaXgpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wb3N0Zml4ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiRWFjaCB2ZXJzZSBwcmVmaXhcIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJTdHJpbmcgaW5zZXJ0ZWQgaW4gZnJvbnQgb2YgZXZlcnkgY29waWVkIHZlcnNlLiBZb3UgY2FuIHVzZSBcXFwie259XFxcIiB3aGVyZSB5b3Ugd2FudCBudW1iZXIgb2YgZ2l2ZW4gdmVyc2UgaW5zZXJ0ZWQsIGZvciBleGFtcGxlIFxcXCIqKntufSoqIFxcXCIgd2lsbCBtYWtlIGVhY2ggdmVyc2Ugc3RhcnQgd2l0aCBib2xkIHZlcnNlIG51bWJlci4gWW91IGNhbiBhbHNvIHVzZSBcXFwie2Z9XFxcIiB0byBpbnNlcnQgbmFtZSBvZiB0aGUgY29ycmVzcG9uZGluZyBmaWxlIChmb3IgZXhhbXBsZSB0byBjcmVhdGUgb2JzaWRpYW4gbGlua3MpLiBMZWF2ZSBlbXB0eSBmb3Igbm8gcHJlZml4LlwiKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCgoaW5wdXRCb3gpID0+XHJcbiAgICAgICAgICAgICAgICBpbnB1dEJveFxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkluc2VydCBwcmVmaXggaGVyZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lYWNoVmVyc2VQcmVmaXgpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lYWNoVmVyc2VQcmVmaXggPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoNFwiLCB7IHRleHQ6IFwiTGlua3NcIiB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTGluayB0byBsYXN0IHZlcnNlP1wiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlNob3VsZCBsYXN0IHZlcnNlIGJlIGxpbmtlZCBpbiB0aGUgdmlzaWJsZSBsaW5rIGJlZm9yZSB0ZXh0IG9mIHZlcnNlcz9cIilcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpbmtFbmRWZXJzZSlcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmxpbmtFbmRWZXJzZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkFkZCBpbnZpc2libGUgbGlua3M/XCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiSW52aXNpYmxlIGxpbmtzIGFyZSBhZGRlZCB0byBlYWNoIHZlcnNlIHVzZWQgKHNvIHlvdSBjYW4gZmluZCB0aGUgY29ubmVjdGlvbnMgbGF0ZXIpLCB0aGV5IGFyZSBvbmx5IHZpc2libGUgaW4gc291cmNlIG1vZGUuXCIpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VJbnZpc2libGVMaW5rcylcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZUludmlzaWJsZUxpbmtzID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTGluayBvbmx5IGRlZmF1bHRcIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJXaGF0IHRoZSBsaW5rIG9ubHkgb3B0aW9uIHNob3VsZCBiZSBzZXQgdG8gYnkgZGVmYXVsdFwiKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGlua09ubHkpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5saW5rT25seSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG5cclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImg0XCIsIHsgdGV4dDogXCJPdXRwdXQgZm9ybWF0XCIgfSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIlB1dCBlYWNoIHZlcnNlIG9uIGEgbmV3IGxpbmU/XCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiRWFjaCB2ZXJzZSBpcyBpbnNlcnRlZCBvbiBhIG5ldyBsaW5lICh3aXRoIExpbmsgcHJlZml4KS5cIilcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm5ld0xpbmVzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubmV3TGluZXMgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJJbnNlcnQgc3BhY2UgYmV0d2VlbiB2ZXJzZXM/XCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiU2hvdWxkIHNwYWNlIGJlIGluc2VydGVkIGJldHdlZW4gdmVyc2VzPyAoT25seSBhcHBsaWVkIHdoZW4gUHV0IGVhY2ggdmVyc2Ugb24gYSBuZXcgbGluZT8gaXMgc2UgdG8gZmFsc2UuIFVzZWZ1bCBmb3IgbGFuZ3VhZ2VzIHN1Y2ggYXMgQ2hpbmVzZS4pXCIpXHJcbiAgICAgICAgICAgIC5zZXREaXNhYmxlZCghdGhpcy5wbHVnaW4uc2V0dGluZ3MubmV3TGluZXMpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbnNlcnRTcGFjZSlcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluc2VydFNwYWNlID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcblxyXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDRcIiwgeyB0ZXh0OiBcIk5vdGF0aW9uXCIgfSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIk9uZSB2ZXJzZSBub3RhdGlvblwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlRoaXMgaXMgdGhlIHN5bWJvbCB0aGF0IHdpbGwgYmUgdXNlZCBiZXR3ZWVuIGNoYXB0ZXIgbnVtYmVyIGFuZCB2ZXJzZSBudW1iZXIgd2hlbiBjb3B5aW5nIG9uZSB2ZXJzZS4gRm9yIGV4YW1wbGUgXFxcIi5cXFwiIFx1MjE5MiBHZW4gMS4xLlwiKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCgoaW5wdXRCb3gpID0+XHJcbiAgICAgICAgICAgICAgICBpbnB1dEJveFxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkluc2VydCBub3RhdGlvbiBzeW1ib2wgaGVyZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vbmVWZXJzZU5vdGF0aW9uKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub25lVmVyc2VOb3RhdGlvbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIk11bHRpcGxlIHZlcnNlcyBub3RhdGlvblwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlRoaXMgaXMgdGhlIHN5bWJvbCB0aGF0IHdpbGwgYmUgdXNlZCBiZXR3ZWVuIGNoYXB0ZXIgbnVtYmVyIGFuZCB2ZXJzZSBudW1iZXIgd2hlbiBjb3B5aW5nIG11bHRpcGxlIHZlcnNlcy4gRm9yIGV4YW1wbGUgXFxcIixcXFwiIFx1MjE5MiBHZW4gMSwxLTMuXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KChpbnB1dEJveCkgPT5cclxuICAgICAgICAgICAgICAgIGlucHV0Qm94XHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiSW5zZXJ0IG5vdGF0aW9uIHN5bWJvbCBoZXJlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm11bHRpcGxlVmVyc2VzTm90YXRpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tdWx0aXBsZVZlcnNlc05vdGF0aW9uID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoNFwiLCB7IHRleHQ6IFwiTXVsdGlwbGUgdHJhbnNsYXRpb25zXCIgfSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIkVuYWJsZSBtdWx0aXBsZSB0cmFuc2xhdGlvbnNcIilcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU11bHRpcGxlVHJhbnNsYXRpb25zKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlTXVsdGlwbGVUcmFuc2xhdGlvbnMgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIClcclxuXHJcblxyXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVNdWx0aXBsZVRyYW5zbGF0aW9ucykge1xyXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgICAgIC5zZXROYW1lKFwiUGF0aHMgdG8gdHJhbnNsYXRpb25zIHdpdGggdGhlaXIgbmFtZXNcIilcclxuICAgICAgICAgICAgICAgIC5zZXREZXNjKFwiSW5wdXQgZnVsbCBwYXRocyBmcm9tIHRoZSByb290IHZhbHV0IGZvbGRlciB0byBmb2xkZXJzIGNvbnRhaW5pbmcgQmlibGUgdHJhbnNsYXRpb25zLCBlYWNoIHRybmFzbGF0aW9uIG9uIHNlcGFyYXRlIGxpbmUuIEFuIGV4YW1wbGUgb2Ygb25lIGVudHJ5OiBcXFwiQmlibGUvTklWL1xcXCIuIFRoZSBwbHVnaW4gd2lsbCBzZWFyY2ggZm9yIGNvcnJlc3BvbmRpbmcgQmlibGUgZmlsZXMgdXNpbmcgZ2l2ZW4gcGF0aHMgYXMgc3RhcnRpbmcgcG9pbnRzLiBNYWtlIHN1cmUgdGhlcmUgYXJlIG5vIGR1cGxpY2F0ZSBmaWxlcyBpbiBnaXZlbiBwYXRocywgb3RoZXJ3aXNlIGl0IGlzIGhhcmQgdG8gdGVsbCB3aGF0IHRoZSBvdXRwdXQgd2lsbCBiZS4gVGhlIGZpcnN0IHRyYW5zbGF0aW9uIHdpbGwgYmUgY29uc2lkZXJlZCB5b3VyIG1haW4gdHJhbnNsYXRpb24uXCIpLmFkZFRleHRBcmVhKChpbnB1dEJveCkgPT5cclxuICAgICAgICAgICAgICAgICAgICBpbnB1dEJveFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJCaWJsZS9OSVYvXFxuQmlibGUvRVNWL1wiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudHJhbnNsYXRpb25zUGF0aHMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0UGF0aHMgPSB2YWx1ZS5zcGxpdCgvXFxyP1xcbnxcXHIvKTsgLy8gc3BsaXQgdXNlciBpbnB1dCBieSBsaW5lcyAocmVnZXggdGFrZXMgaW50byBhY2NvdW50IGFsbCBwb3NzaWJsZSBsaW5lIGVuZGluZ3MpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXRoczogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UGF0aHMuZm9yRWFjaCgocGF0aCkgPT4geyAvLyBwYXJzZSB1c2VyIGlucHV0IGZvciBsYXRlciB1c2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGF0aC5hdCgtMSkgIT09IFwiL1wiKSB7IC8vIEFkZCBwb3RlbnRpb25hbGx5IG1pc3NpbmcgJy8nIHRvIHBhdGhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aHMucHVzaChwYXRoICsgXCIvXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aHMucHVzaChwYXRoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50cmFuc2xhdGlvbnNQYXRocyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucGFyc2VkVHJhbnNsYXRpb25QYXRocyA9IHBhdGhzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICApXHJcblxyXG5cclxuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgICAgICAuc2V0TmFtZShcIldoYXQgdG8gbGlua1wiKVxyXG4gICAgICAgICAgICAgICAgLnNldERlc2MoXCJDaG9vc2Ugd2hhdCB0cmFuc2xhdGlvbnMgc2hvdWxkIGJlIGxpbmtlZCB3aGVuIGNvcHlpbmcgYSB2ZXJzZS5cIilcclxuICAgICAgICAgICAgICAgIC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJhbGxcIiwgXCJMaW5rIHRvIGFsbCB0cmFuc2xhdGlvbnNcIilcclxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJ1c2VkXCIsIFwiTGluayBvbmx5IHRvIHVzZWQgdHJhbnNsYXRpb25cIilcclxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJ1c2VkQW5kTWFpblwiLCBcIkxpbmsgdG8gdXNlZCBhbmQgbWFpbiB0cmFuc2xhdGlvblwiKVxyXG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcIm1haW5cIiwgXCJMaW5rIG9ubHkgdG8gbWFpbiB0cmFuc2xhdGlvblwiKVxyXG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnRyYW5zbGF0aW9uTGlua2luZ1R5cGUpXHJcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24ub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRyYW5zbGF0aW9uTGlua2luZ1R5cGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgLy8gTElOSyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIkxpbmsgQmlibGUgdmVyc2VzIGNvbW1hbmRcIiB9KTtcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoNFwiLCB7IHRleHQ6IFwiRmlsZSBmb3JtYXRcIiB9KTtcclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJMaW5rIHNlcGFyYXRvclwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlRoaXMgaXMgdGhlIHNlcGFyYXRvciB0aGF0IHdpbGwgYmUgdXNlZCB3aGVuIGxpbmtpbmcsIGUuZy4gaWYgeW91IGVudGVyICcjJyBoZXJlLCBvdXRwdXQgd2lsbCBiZSBbW0dlbiAxIzFdXS4gSWYgeW91IGFyZSB1c2luZyBoZWFkaW5ncyB0byBtYXJrIHZlcnNlcywgdXNlICcjJy4gSWYgeW91IGFyZSB1c2luZyBibG9jayByZWZlcmVuY2VzLCB1c2UgJ14nLlwiKVxyXG4gICAgICAgICAgICAuc2V0Q2xhc3MoXCJpbXBvcnRhbnQtc2V0dGluZ1wiKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCgoaW5wdXRCb3gpID0+XHJcbiAgICAgICAgICAgICAgICBpbnB1dEJveFxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkluc2VydCBzZXBhcmF0b3IgaGVyZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saW5rU2VwYXJhdG9yKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubGlua1NlcGFyYXRvciA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJWZXJzZSBwcmVmaXhcIilcclxuICAgICAgICAgICAgLnNldERlc2MoJ0ZpbGwgdGhpcyBpZiB5b3UgYXJlIHVzaW5nIHZlcnNlIHByZWZpeGVzIGluIHlvdXIgYmlibGUgZmlsZXMsIGUuZy4geW91IGhhdmUgXCJ2MVwiIGluIHlvdXIgZmlsZSBcdTIxOTIgc2V0IHRvIFwidlwiLicpXHJcbiAgICAgICAgICAgIC5zZXRDbGFzcyhcImltcG9ydGFudC1zZXR0aW5nXCIpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KChpbnB1dEJveCkgPT5cclxuICAgICAgICAgICAgICAgIGlucHV0Qm94XHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiSW5zZXJ0IHByZWZpeCBoZXJlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnZlcnNlUHJlZml4KVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyc2VQcmVmaXggPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoNFwiLCB7IHRleHQ6IFwiRGVmYXVsdHNcIiB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTGluayB0eXBlIGRlZmF1bHQgdmFsdWVcIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJWYWx1ZSB0aGF0IHdpbGwgYmUgc2VsZWN0ZWQgYnkgZGVmYXVsdCBpbiBsaW5rIG1vZGFsLlwiKVxyXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oTGlua1R5cGUuQmFzaWMsIExpbmtUeXBlLkJhc2ljKVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKExpbmtUeXBlLkVtYmVkZGVkLCBMaW5rVHlwZS5FbWJlZGRlZClcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihMaW5rVHlwZS5JbnZpc2libGUsIExpbmtUeXBlLkludmlzaWJsZSlcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpbmtUeXBlUHJlc2V0KVxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24ub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubGlua1R5cGVQcmVzZXQgPSB2YWx1ZSBhcyBMaW5rVHlwZTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZShcIlVzZSBuZXcgbGluZXMgZGVmYXVsdCB2YWx1ZVwiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlZhbHVlIHRoYXQgd2lsbCBiZSBzZWxlY3RlZCBieSBkZWZhdWx0IGluIGxpbmsgbW9kYWwuXCIpXHJcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5uZXdMaW5lUHJlc2V0KVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubmV3TGluZVByZXNldCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApXHJcblxyXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDRcIiwgeyB0ZXh0OiBcIk1pc2NcIiB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiVmVyaWZ5IGZpbGVzP1wiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlZlcmlmeSBleGlzdGVuY2Ugb2YgZmlsZXMgeW91IGFyZSB0cnlpbmcgdG8gbGluaywgc28gdGhhdCB5b3UgYXJlIG5vdCBpbnNlcnRpbmcgd3JvbmcgcmVmZXJlbmNlcyBieSBtaXN0YWtlLlwiKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudmVyaWZ5RmlsZXNXaGVuTGlua2luZylcclxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnZlcmlmeUZpbGVzV2hlbkxpbmtpbmcgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKVxyXG5cclxuXHJcbiAg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
